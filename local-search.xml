<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>å‚æ•°é«˜æ•ˆå¾®è°ƒ</title>
    <link href="/2024/09/07/%E5%8F%82%E6%95%B0%E9%AB%98%E6%95%88%E5%BE%AE%E8%B0%83/"/>
    <url>/2024/09/07/%E5%8F%82%E6%95%B0%E9%AB%98%E6%95%88%E5%BE%AE%E8%B0%83/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>TSCILè®ºæ–‡ç¬”è®°Â·II</title>
    <link href="/2024/09/04/TSCIL%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0%C2%B7II/"/>
    <url>/2024/09/04/TSCIL%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0%C2%B7II/</url>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"><style>.center {  width: auto;  display: table;  margin-left: auto;  margin-right: auto;  margin-top: 20px;}</style><h1 id="æ—¶é—´çº¿">ã€‡ã€æ—¶é—´çº¿</h1><p><strong>9æœˆ4æ—¥~9æœˆ6æ—¥</strong></p><ol type="1"><li>å†»ç»“Transformerå‚æ•°ï¼Œåªåˆ©ç”¨MOMENTçš„åˆ†ç±»å™¨åœ¨Benchmarkä¸Šè¿›è¡Œè®­ç»ƒä¸æµ‹è¯•ï¼Œåœ¨3ä¸ªç®€å•æ•°æ®é›†ä¸Šæ•ˆæœå¾ˆå¥½ï¼ˆè§2.2ï¼‰</li><li>åˆ©ç”¨T-SNEè¿›è¡Œé™ç»´ï¼Œæ²¡æœ‰å¾—åˆ°æœ‰å¯å‘çš„ä¿¡æ¯ï¼›éšåå°è¯•è°ƒå‚ï¼ˆBatchsizeã€Lrï¼‰ã€è§£å†»Transformerå‚æ•°æ¥è§‚å¯Ÿ<code>GrabMyo</code>ä¸Šçš„æ•ˆæœ</li><li>é˜…è¯»ç»¼è¿°åŠç›¸å…³è®ºæ–‡</li><li>æ”¹å°è®­ç»ƒé›†ï¼Œé‡æ–°è®­ç»ƒ<code>Grabmyo</code></li></ol><h1 id="ä¸€ç›¸å…³å·¥ä½œ">ä¸€ã€ç›¸å…³å·¥ä½œ</h1><ol type="1"><li><a href="https://arxiv.org/abs/2402.02713">Position: What Can Large Language Models Tell Us about Time Series Analysis</a></li><li><a href="https://arxiv.org/abs/2403.14735">Foundation Models for Time Series Analysis: A Tutorial and Survey</a></li><li><a href="https://arxiv.org/abs/2401.16386">Continual Learning with Pre-Trained Models: A Survey</a></li><li><a href="https://arxiv.org/abs/2303.07338">SimpleCIL &amp; APERï¼šRevisiting Class-Incremental Learning with Pre-Trained Models: Generalizability and Adaptivity are All You Need</a></li></ol><h2 id="simplecil-aper">4ã€SimpleCIL &amp; APER</h2><figure><img src="/2024/09/04/TSCIL%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0%C2%B7II/APER.png" alt="APERæ¡†æ¶"><figcaption aria-hidden="true">APERæ¡†æ¶</figcaption></figure><h3 id="è¡¨ç¤º">4.1 è¡¨ç¤º</h3><ul><li>è®­ç»ƒä»»åŠ¡ï¼š<span class="math inline">\(\{\mathcal D^1,\mathcal D^2,\cdots,\mathcal D^b\}\)</span></li><li>Prototypeï¼š<span class="math inline">\({\rm p_i}=\frac{1}{K}\sum\limits_{j=1}^{|\mathcal D^b|}\mathbb I(y_j=i)\phi(x_j)ï¼ŒK=\sum\limits_{j=1}^{|\mathcal D^b|}\mathbb I(y_j=i)ï¼Œ\mathbb I(\cdot)\)</span>ä¸ºç¤ºæ€§å‡½æ•°</li><li>åˆ†ç±»å™¨ï¼š<span class="math inline">\(f(x)=W^T\phi(x)ï¼Œ\phi(\cdot)\)</span>ä¸ºembeddingå‡½æ•°ï¼Œ<span class="math inline">\(W\in\mathbb R^{d\times |y_b|}\)</span>æ˜¯åˆ†ç±»å¤´</li></ul><h3 id="ç®—æ³•">4.2 ç®—æ³•</h3><p><img src="/2024/09/04/TSCIL%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0%C2%B7II/APERç®—æ³•.png"></p><ol type="1"><li><p>PTMæ·»åŠ parameter-efficient moduleååœ¨<span class="math inline">\(\mathcal D^1\)</span>ä¸Šå¾®è°ƒå¾—åˆ°AdaPTM</p><ul><li><p>æŒ‰åºå¾®è°ƒæ¨¡å‹ä¼šå¯¼è‡´ç¾éš¾æ€§é—å¿˜</p><figure><img src="/2024/09/04/TSCIL%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0%C2%B7II/Adapt.png" alt="å¾®è°ƒå‰Tä¸ªä»»åŠ¡çš„ç»“æœ"><figcaption aria-hidden="true">å¾®è°ƒå‰Tä¸ªä»»åŠ¡çš„ç»“æœ</figcaption></figure></li><li><p>å› ä¸ºä½¿ç”¨prototype-basedåˆ†ç±»å™¨ï¼Œå› æ­¤å¤šæ¬¡å¾®è°ƒä¼šå¯¼è‡´å‰åprototypeçš„ç‰¹å¾ä¸å…¼å®¹</p><blockquote><p>Since we utilize a prototype-based classifier, tuning the model with multiple stages will result in incompatible features between former and new prototypes.</p></blockquote></li></ul></li><li><p>å°†PTMå’ŒAdaPTMçš„embeddingå±‚å†»ç»“ï¼ˆåªè®­ç»ƒåˆ†äº†é‡Œå¤´å’ŒAdaModuleé‡Œçš„å‚æ•°ï¼‰</p></li><li><p>å¯¹äºæ¯ä¸€ä¸ªä»»åŠ¡ï¼Œè®¡ç®—å…¶æ•°æ®çš„Prototypeå¹¶æ›¿ä»£åˆ†ç±»å¤´çš„æƒé‡</p></li><li><p>é€šè¿‡è®¡ç®—ä½™å¼¦ç›¸ä¼¼åº¦æ¥è·å¾—åˆ†ç±»ç»“æœ</p></li></ol><h3 id="adaptæ–¹æ³•aperæ¡†æ¶å›¾çš„ä¸­å³éƒ¨åˆ†">4.3 Adaptæ–¹æ³•ï¼ˆAPERæ¡†æ¶å›¾çš„ä¸­ã€å³éƒ¨åˆ†ï¼‰</h3><ul><li>Visual Prompt Tuningï¼ˆVPTï¼‰ï¼šé€‚åˆäºViT<ul><li>VPT-Deepï¼šåœ¨æ¯ä¸€ä¸ªæ³¨æ„åŠ›å±‚åŠ Prompt</li><li>VPT-Shallowï¼šåªåœ¨ç¬¬ä¸€å±‚åŠ Prompt</li></ul></li><li>Scale &amp; Shiftï¼ˆSSFï¼‰ï¼š<span class="math inline">\(x_{output}=\gamma\otimes x_{input}+\beta\)</span>ï¼Œä»è€Œå°†åˆ†å¸ƒé€‚åº”äºæ–°ä»»åŠ¡</li><li>Adapterï¼š<span class="math inline">\({\rm MLP}(x_l)+{\rm RELU}(x_{l}W_{down})W_{up}\)</span></li><li>Batch Normalization Tuningï¼šé€‚åˆäºCNN-basedæ¨¡å‹</li></ul><h3 id="å®éªŒç»“æœ">4.4 å®éªŒç»“æœ</h3><p><img src="/2024/09/04/TSCIL%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0%C2%B7II/APERæ¶ˆè.png"></p><p><img src="/2024/09/04/TSCIL%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0%C2%B7II/APERç»“æœ.png"></p><h1 id="äºŒmoment">äºŒã€MOMENT</h1><h2 id="æµ‹è¯•ä»£ç ">2.1 æµ‹è¯•ä»£ç </h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sys<br>sys.path.append(<span class="hljs-string">&quot;/home/eee/zym/&quot;</span>)<br>sys.path.append(<span class="hljs-string">&quot;/home/eee/zym/TSCIL/&quot;</span>)<br>sys.path.append(<span class="hljs-string">&quot;/home/eee/zym/TSCIL/utils/&quot;</span>)<br><br><span class="hljs-keyword">import</span> torch<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">from</span> torch <span class="hljs-keyword">import</span> nn<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> tqdm<br><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt <br><span class="hljs-keyword">from</span> momentfm <span class="hljs-keyword">import</span> MOMENTPipeline<br><span class="hljs-keyword">from</span> torch.optim <span class="hljs-keyword">import</span> lr_scheduler<br><span class="hljs-keyword">from</span> EarlyStop <span class="hljs-keyword">import</span> EarlyStopping<br><span class="hljs-keyword">from</span> torch.utils.data <span class="hljs-keyword">import</span> DataLoader,Dataset<br><span class="hljs-keyword">from</span> stream <span class="hljs-keyword">import</span> IncrementalTaskStream,get_cls_order<br>device = torch.device(<span class="hljs-string">&quot;cuda&quot;</span> <span class="hljs-keyword">if</span> torch.cuda.is_available() <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;cpu&quot;</span>)<br>DATA=<span class="hljs-string">&quot;wisdm&quot;</span><br><span class="hljs-comment"># [&#x27;har&#x27;, &#x27;uwave&#x27;, &#x27;dailysports&#x27;, &#x27;grabmyo&#x27;, &#x27;wisdm&#x27;,&#x27;ninapro&#x27;, &#x27;sines&#x27;]</span><br><span class="hljs-comment"># ============================åˆå§‹åŒ–MOMENT============================</span><br>model = MOMENTPipeline.from_pretrained(<br>    <span class="hljs-string">&quot;AutonLab/MOMENT-1-large&quot;</span>, <br>    model_kwargs=&#123;<br>        <span class="hljs-string">&#x27;task_name&#x27;</span>: <span class="hljs-string">&#x27;classification&#x27;</span>,<br>        <span class="hljs-string">&#x27;n_channels&#x27;</span>: <span class="hljs-number">3</span>,<br>        <span class="hljs-string">&#x27;num_class&#x27;</span>: <span class="hljs-number">18</span>,<br>        <span class="hljs-string">&#x27;freeze_encoder&#x27;</span>: <span class="hljs-literal">True</span>, <span class="hljs-comment"># Freeze the patch embedding layer</span><br>        <span class="hljs-string">&#x27;freeze_embedder&#x27;</span>: <span class="hljs-literal">True</span>, <span class="hljs-comment"># Freeze the transformer encoder</span><br>        <span class="hljs-string">&#x27;freeze_head&#x27;</span>: <span class="hljs-literal">False</span>, <span class="hljs-comment"># The linear forecasting head must be trained</span><br>    &#125;, <br>   )<br>model.init()<br>model.to(device)<br><br><span class="hljs-comment"># ============================è·å–æ•°æ®é›†============================</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyDataset</span>(<span class="hljs-title class_ inherited__">Dataset</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, data, targets</span>):<br>        <span class="hljs-variable language_">self</span>.data = data<br>        <span class="hljs-variable language_">self</span>.targets = targets<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__len__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">len</span>(<span class="hljs-variable language_">self</span>.data)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__getitem__</span>(<span class="hljs-params">self, idx</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>.data[idx], <span class="hljs-variable language_">self</span>.targets[idx]<br><br>cls_order = get_cls_order(DATA, <span class="hljs-literal">False</span>)<br>task_stream = IncrementalTaskStream(data=DATA, scenario=<span class="hljs-string">&#x27;class&#x27;</span>, cls_order=cls_order,split=<span class="hljs-string">&#x27;all&#x27;</span>)<br>(x_train, y_train), (x_val, y_val), (x_test, y_test) = task_stream.setup_offline()<br>x_train,x_val,x_test=np.transpose(x_train,(<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>)),np.transpose(x_val,(<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>)),np.transpose(x_test,(<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>))<br><br>train_dataloader = DataLoader(MyDataset(x_train,y_train), batch_size=<span class="hljs-number">64</span>, num_workers=<span class="hljs-number">4</span>,pin_memory=<span class="hljs-literal">True</span>,shuffle=<span class="hljs-literal">True</span>)<br>val_dataloader = DataLoader(MyDataset(x_val,y_val), batch_size=<span class="hljs-number">64</span>, num_workers=<span class="hljs-number">4</span>,pin_memory=<span class="hljs-literal">True</span>,shuffle=<span class="hljs-literal">True</span>)<br>test_dataloader = DataLoader(MyDataset(x_test,y_test), batch_size=<span class="hljs-number">64</span>, num_workers=<span class="hljs-number">4</span>,pin_memory=<span class="hljs-literal">True</span>,shuffle=<span class="hljs-literal">True</span>)<br><br><span class="hljs-comment"># ============================è¶…å‚æ•°è®¾ç½®============================</span><br>criterion = nn.CrossEntropyLoss()<br>optimizer = torch.optim.Adam(model.parameters(), lr=<span class="hljs-number">1e-3</span>)<br>scheduler=lr_scheduler.StepLR(optimizer, step_size=<span class="hljs-number">1</span>, gamma=<span class="hljs-number">0.95</span>)<br><br><br>EPOCH = <span class="hljs-number">100</span><br>patience=<span class="hljs-number">20</span><br>Acc,Loss,ValidLoss=[],[],[]<br><br><span class="hljs-comment"># ============================ç”»å›¾å‡½æ•°============================</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Draw</span>(<span class="hljs-params">X,Y,Z</span>):<br>    plt.plot(X,Y,linestyle=<span class="hljs-string">&#x27;--&#x27;</span>,label=<span class="hljs-string">&#x27;loss&#x27;</span>)<br>    plt.plot(X,Z,label=<span class="hljs-string">&quot;acc&quot;</span>)<br>    plt.legend()<br>    plt.savefig(<span class="hljs-string">f&#x27;./<span class="hljs-subst">&#123;DATA&#125;</span>_res.png&#x27;</span>) <br><br><br><br><span class="hljs-comment"># ===============================å®šä¹‰æµ‹è¯•å‡½æ•°=========================</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test</span>(<span class="hljs-params">epoch,mode</span>):<br>    <span class="hljs-keyword">if</span> mode==<span class="hljs-string">&#x27;test&#x27;</span>:dataloader=test_dataloader<br>    <span class="hljs-keyword">elif</span> mode==<span class="hljs-string">&quot;val&quot;</span>:dataloader=val_dataloader<br><br>    model.<span class="hljs-built_in">eval</span>()<br>    correct,total,Validloss=<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span><br>    <span class="hljs-keyword">with</span> torch.no_grad():<br>        <span class="hljs-keyword">for</span> data,label <span class="hljs-keyword">in</span> dataloader:<br>            output = model(data.to(torch.<span class="hljs-built_in">float</span>).to(device))<br>            Validloss+= criterion(output.logits, label.to(device))<br>            _, predicted = torch.<span class="hljs-built_in">max</span>(output.logits, dim=<span class="hljs-number">1</span>) <br>            total += label.size(<span class="hljs-number">0</span>)  <span class="hljs-comment"># å¼ é‡ä¹‹é—´çš„æ¯”è¾ƒè¿ç®—</span><br>            correct += (predicted == label.to(device)).<span class="hljs-built_in">sum</span>().item()<br>        acc = correct / total<br>        ValidLoss.append(Validloss/<span class="hljs-built_in">len</span>(dataloader))<br>        <span class="hljs-keyword">if</span> mode==<span class="hljs-string">&#x27;val&#x27;</span>:<br>            Acc.append(acc)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[%d / %d]: éªŒè¯é›†å‡†ç¡®ç‡: %.1f %% &#x27;</span> % (epoch+<span class="hljs-number">1</span>, EPOCH, <span class="hljs-number">100</span> * acc)) <br>        <span class="hljs-keyword">else</span>:<span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;æµ‹è¯•é›†å‡†ç¡®ç‡: %.1f %% &#x27;</span> % (<span class="hljs-number">100</span> * acc))<br>    <br><br><br><span class="hljs-comment"># ===============================è®­ç»ƒ=========================</span><br>early_stopping = EarlyStopping(patience=patience, verbose=<span class="hljs-literal">True</span>)<br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(EPOCH):<br>    model.train()<br>    EpochLoss=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> data,label <span class="hljs-keyword">in</span> train_dataloader:<br><br>        <span class="hljs-comment"># forward [batch_size, n_channels, forecast_horizon]</span><br>        output = model(data.to(torch.<span class="hljs-built_in">float</span>).to(device))<br><br>        <span class="hljs-comment"># backward</span><br>        loss = criterion(output.logits, label.to(device))<br>        optimizer.zero_grad()<br>        loss.backward()<br>        optimizer.step()<br>        <br>        EpochLoss+=loss.item()<br>    Loss.append(EpochLoss/<span class="hljs-built_in">len</span>(train_dataloader))<br>    scheduler.step()<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;å­¦ä¹ ç‡:<span class="hljs-subst">&#123;scheduler.get_last_lr()[<span class="hljs-number">0</span>]:<span class="hljs-number">.5</span>f&#125;</span>&quot;</span>)<br>    test(_,<span class="hljs-string">&#x27;val&#x27;</span>)<br><br>    early_stopping(ValidLoss[-<span class="hljs-number">1</span>], model)<br>    <span class="hljs-keyword">if</span> early_stopping.early_stop:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Early stopping&quot;</span>)<br>        <span class="hljs-keyword">break</span><br><br>test(<span class="hljs-literal">None</span>,<span class="hljs-string">&#x27;test&#x27;</span>)<br>Draw([_+<span class="hljs-number">1</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(Loss))],Loss,Acc)<br>torch.save(model,<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;DATA&#125;</span>_ckpt.pt&#x27;</span>)<br></code></pre></td></tr></table></figure><h2 id="æµ‹è¯•ç»“æœ">2.2 æµ‹è¯•ç»“æœ</h2><div class="group-image-container"><div class="group-image-row"><div class="group-image-wrap"><img src="/2024/09/04/TSCIL%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0%C2%B7II/uwave.png"></div><div class="group-image-wrap"><img src="/2024/09/04/TSCIL%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0%C2%B7II/har.png"></div><div class="group-image-wrap"><img src="/2024/09/04/TSCIL%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0%C2%B7II/sports.png"></div></div><div class="group-image-row"><div class="group-image-wrap"><img src="/2024/09/04/TSCIL%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0%C2%B7II/grabmyo.png"></div><div class="group-image-wrap"><img src="/2024/09/04/TSCIL%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0%C2%B7II/wisdm.png"></div></div></div><h2 id="é’ˆå¯¹grabmyoçš„è°ƒå‚">2.3 é’ˆå¯¹<code>GrabMyo</code>çš„è°ƒå‚</h2><table><thead><tr class="header"><th style="text-align: center;">æ•°æ®å¤„ç†/è®­ç»ƒéƒ¨åˆ†</th><th style="text-align: center;">Batchsize</th><th style="text-align: center;">Lrï¼ˆgammaï¼‰</th><th style="text-align: center;">Accï¼ˆ%ï¼‰</th></tr></thead><tbody><tr class="odd"><td style="text-align: center;">concat/cls</td><td style="text-align: center;">512</td><td style="text-align: center;">1e-2ï¼ˆ0.95ï¼‰</td><td style="text-align: center;">11.6</td></tr><tr class="even"><td style="text-align: center;">concat/cls</td><td style="text-align: center;">64</td><td style="text-align: center;">1e-3ï¼ˆ0.95ï¼‰</td><td style="text-align: center;">12.1</td></tr><tr class="odd"><td style="text-align: center;">mean/cls</td><td style="text-align: center;">64</td><td style="text-align: center;">1e-2ï¼ˆ0.95ï¼‰</td><td style="text-align: center;">/</td></tr><tr class="even"><td style="text-align: center;">mean/all</td><td style="text-align: center;">64</td><td style="text-align: center;">1e-2ï¼ˆ0.95ï¼‰</td><td style="text-align: center;">/</td></tr><tr class="odd"><td style="text-align: center;">concatï¼ˆ20%ï¼‰/all</td><td style="text-align: center;">64</td><td style="text-align: center;">1e-2ï¼ˆ0.95ï¼‰</td><td style="text-align: center;">6.2</td></tr><tr class="even"><td style="text-align: center;">concatï¼ˆ20%ï¼‰/all</td><td style="text-align: center;">64</td><td style="text-align: center;">1e-3ï¼ˆ0.95ï¼‰</td><td style="text-align: center;"></td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>æŠ€æœ¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è®ºæ–‡</tag>
      
      <tag>ç±»å¢é‡å­¦ä¹ </tag>
      
      <tag>å¾®è°ƒ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å“ˆå¸Œè¡¨</title>
    <link href="/2024/09/04/%E5%93%88%E5%B8%8C%E8%A1%A8/"/>
    <url>/2024/09/04/%E5%93%88%E5%B8%8C%E8%A1%A8/</url>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"><p>å½“éœ€è¦æŸ¥è¯¢ä¸€ä¸ªå…ƒç´ æ˜¯å¦å‡ºç°è¿‡ã€ä¸€ä¸ªå…ƒç´ æ˜¯å¦åœ¨é›†åˆé‡Œã€å…ƒç´ å‡ºç°æ¬¡æ•°çš„æ—¶å€™ï¼Œä½¿ç”¨å“ˆå¸Œè¡¨</p><ol type="1"><li><a href="https://leetcode.cn/problems/4sum-ii/">454. 4Sum II</a></li></ol>]]></content>
    
    
    <categories>
      
      <category>æŠ€æœ¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŠ›æ‰£</tag>
      
      <tag>å“ˆå¸Œè¡¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¤§æ¨¡å‹æ¶æ„</title>
    <link href="/2024/09/02/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E6%9E%B6%E6%9E%84/"/>
    <url>/2024/09/02/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E6%9E%B6%E6%9E%84/</url>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"><h1 id="auto-encoder-vs-auto-regressive">1ã€Auto-encoder vs Auto-regressive</h1><p>ä»é¢„è®­ç»ƒæ¨¡å‹çš„è§’åº¦ä¸Šæ¥çœ‹ï¼Œä¸¤è€…çš„æ¨¡å‹ç»“æ„å¯èƒ½æ˜¯ä¸€æ ·çš„ï¼Œä¸åŒçš„æ˜¯é¢„è®­ç»ƒçš„æ–¹å¼</p><ul><li>è‡ªç¼–ç æ¨¡å‹ï¼šé¢„è®­ç»ƒæ—¶å¯ä»¥çœ‹åˆ°ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼ŒæŒ‡BERTç­‰ï¼›å¹¿ä¹‰æ¥è®²æ˜¯è‡ªç¼–ç å™¨ï¼ˆAEï¼‰ï¼ŒåŒ…å«VAE</li><li>è‡ªå›å½’æ¨¡å‹ï¼šé¢„è®­ç»ƒæ—¶åªèƒ½çœ‹åˆ°ä¸Šæ–‡æˆ–è€…ä¸‹æ–‡ï¼ŒæŒ‡GPTã€ELMOç­‰ï¼›å¹¿ä¹‰æ¥è®²å°±æ˜¯åˆ©ç”¨è¿‡å»è§‚æµ‹å€¼é¢„æµ‹æœªæ¥å€¼çš„æ¨¡å‹ï¼Œä¹ŸåŒ…å«RNNã€LSTM</li></ul><p><strong>å‚è€ƒ</strong></p><ol type="1"><li><a href="https://blog.csdn.net/weixin_43301333/article/details/128141716?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522170848482516800222831072%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&amp;request_id=170848482516800222831072&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-1-128141716-null-null.nonecase&amp;utm_term=encoder&amp;spm=1018.2226.3001.4450">Transformer Encoder-Decoer ç»“æ„å›é¡¾</a></li><li><a href="https://www.cnblogs.com/AudreyXu/p/17197943.html">è‡ªå›å½’å’Œè‡ªç¼–ç æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</a></li></ol><h1 id="å¤§æ¨¡å‹æ¶æ„">2ã€å¤§æ¨¡å‹æ¶æ„</h1><p><img src="https://i-blog.csdnimg.cn/blog_migrate/8aba45c21032e2d07fd783070ad8483a.png"></p><ul><li>Encoder-Decoderï¼ˆT5ï¼‰</li><li>Decoder Onlyï¼ˆGPTï¼‰</li><li>Encoder Onlyï¼ˆBERTï¼‰</li><li>Prefix LMï¼ˆGLMï¼‰</li></ul><p><strong>å‚è€ƒ</strong></p><ol type="1"><li><a href="https://www.zhihu.com/question/588325646/answer/2940298964">ä¸ºä»€ä¹ˆç°åœ¨çš„LLMéƒ½æ˜¯Decoder onlyçš„æ¶æ„ï¼Ÿ - è‹å‰‘æ—çš„å›ç­” - çŸ¥ä¹</a></li><li><a href="https://www.zhihu.com/question/588325646/answer/3357252612">ä¸ºä»€ä¹ˆç°åœ¨çš„LLMéƒ½æ˜¯Decoder onlyçš„æ¶æ„ï¼Ÿ - Samå¤šåƒé’èœçš„å›ç­” - çŸ¥ä¹</a></li></ol>]]></content>
    
    
    <categories>
      
      <category>æŠ€æœ¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å¤§æ¨¡å‹</tag>
      
      <tag>ç¼–ç å™¨</tag>
      
      <tag>è§£ç å™¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>PytorchåŠ é€Ÿè®­ç»ƒMNIST</title>
    <link href="/2024/08/29/Pytorch%E5%8A%A0%E9%80%9F%E8%AE%AD%E7%BB%83/"/>
    <url>/2024/08/29/Pytorch%E5%8A%A0%E9%80%9F%E8%AE%AD%E7%BB%83/</url>
    
    <content type="html"><![CDATA[<style>.center {  width: auto;  display: table;  margin-left: auto;  margin-right: auto;  margin-top: 20px;}</style><h1 id="å®éªŒè¿‡ç¨‹">0ã€å®éªŒè¿‡ç¨‹</h1><p>ä¸ºäº†å¯¹æ¯”Pytorchä¸­ä¸åŒæ–¹æ³•å¯¹äºè®­ç»ƒé€Ÿåº¦çš„æå‡ï¼Œé‡‡ç”¨æœ€åŸºç¡€çš„<a href="https://blog.csdn.net/qq_45588019/article/details/120935828">MNISTæ•°å­—è¯†åˆ«</a>ï¼ŒåŸºç¡€é…ç½®å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">batch_size = <span class="hljs-number">64</span><br>learning_rate = <span class="hljs-number">0.01</span><br>momentum = <span class="hljs-number">0.5</span><br>EPOCH = <span class="hljs-number">5</span><br><br>criterion = torch.nn.CrossEntropyLoss()  <br>optimizer = torch.optim.SGD(model.parameters(), lr=learning_rate, momentum=momentum)  <br></code></pre></td></tr></table></figure><p>æºç æ˜¯CPUä¸Šè·‘çš„ï¼Œæ”¹åˆ°GPUä¸Šä½œä¸ºä¸€ä¸ªBaselineï¼š</p><div class="center"><table><thead><tr class="header"><th style="text-align: center;">æ–¹æ³•</th><th style="text-align: center;">æµ‹è¯•é›†å‡†ç¡®ç‡ï¼ˆ%ï¼‰</th><th style="text-align: center;">ç”¨æ—¶ï¼ˆsï¼‰</th></tr></thead><tbody><tr class="odd"><td style="text-align: center;">CPU</td><td style="text-align: center;">97.9</td><td style="text-align: center;">25.16</td></tr><tr class="even"><td style="text-align: center;">GPUï¼ˆRTX3080ï¼‰</td><td style="text-align: center;">98.4</td><td style="text-align: center;">20.40</td></tr></tbody></table></div><h1 id="dataloader">1ã€Dataloader</h1><p>çœ‹åˆ°<a href="https://blog.csdn.net/qq_28057379/article/details/115427052">ç½‘ä¸Š</a>æœ‰è¯´å°†<code>num_workers</code>è®¾ç½®æˆCPUæ•°é‡ä¸€æ ·ï¼Œä½†ä¹Ÿæœ‰çš„è¯´å¹¶éè¶Šå¤§è¶Šå¥½ï¼Œå¯èƒ½éœ€è¦è¿›è¡Œå®éªŒé€‰æ‹©æœ€ä½³çš„ã€‚åœ¨è¿™é‡Œæµ‹è¯•é›†å‡†ç¡®ç‡å‚è€ƒæ„ä¹‰å¹¶ä¸å¤§ï¼Œå› ä¸ºå·®è·å¾ˆå°ï¼Œå¹¶ä¸”dataloaderä¸ä¼šå¯¹å‡†ç¡®ç‡é€ æˆæ˜¾è‘—çš„å½±å“ï¼Œå¯èƒ½ä¸å‚æ•°çš„åˆå§‹åŒ–æƒ…å†µæœ‰å…³</p><div class="center"><table><thead><tr class="header"><th style="text-align: center;">å‚æ•°</th><th style="text-align: center;">æµ‹è¯•é›†å‡†ç¡®ç‡ï¼ˆ%ï¼‰</th><th style="text-align: center;">ç”¨æ—¶ï¼ˆsï¼‰</th></tr></thead><tbody><tr class="odd"><td style="text-align: center;">Baseline</td><td style="text-align: center;">98.4</td><td style="text-align: center;">20.40</td></tr><tr class="even"><td style="text-align: center;"><code>num_workers=4</code></td><td style="text-align: center;">98.3</td><td style="text-align: center;">7.54</td></tr><tr class="odd"><td style="text-align: center;"><code>pin_memory=True</code></td><td style="text-align: center;">98.7</td><td style="text-align: center;">21.32</td></tr><tr class="even"><td style="text-align: center;"><code>num_workers=4ï¼Œpin_memory=True</code></td><td style="text-align: center;">98.4</td><td style="text-align: center;"><strong>6.14</strong></td></tr></tbody></table></div><h1 id="è‡ªåŠ¨æ··åˆç²¾åº¦-amp">2ã€è‡ªåŠ¨æ··åˆç²¾åº¦ AMP</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python">scaler = GradScaler(enabled=<span class="hljs-literal">True</span>)<br><span class="hljs-keyword">for</span> batch_idx, data <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(train_loader, <span class="hljs-number">0</span>):<br>        inputs, target = data<br>        optimizer.zero_grad()<br><br>        <span class="hljs-keyword">with</span> autocast(enabled=<span class="hljs-literal">True</span>, dtype=torch.float16):<br>            outputs = model(inputs.to(device))<br>            loss = criterion(outputs, target.to(device))<br><br>            scaler.scale(loss).backward()<br>            scaler.step(optimizer)<br>            scaler.update()   <br></code></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªå®éªŒä¸­AMPå¹¶æœªæé€Ÿï¼Œåè€Œè¿˜æ…¢äº†ï¼ŒçŒœæƒ³æ˜¯å› ä¸ºæ•°æ®é›†è§„æ¨¡å¤ªå°ã€‚ä¸è¿‡åœ¨ä¹‹å‰çš„æ¯”èµ›ä¸­ï¼Œåœ¨å¯¹å¤§æ¨¡å‹æ¨ç†æ—¶ä½¿ç”¨æ··åˆç²¾åº¦ç¡®å®æœ‰å‡å°‘æ¨ç†æ—¶é—´</p><div class="center"><table><thead><tr class="header"><th style="text-align: center;">å‚æ•°</th><th style="text-align: center;">æµ‹è¯•é›†å‡†ç¡®ç‡ï¼ˆ%ï¼‰</th><th style="text-align: center;">ç”¨æ—¶ï¼ˆsï¼‰</th></tr></thead><tbody><tr class="odd"><td style="text-align: center;">Baseline</td><td style="text-align: center;">98.4</td><td style="text-align: center;"><strong>20.40</strong></td></tr><tr class="even"><td style="text-align: center;">AMP</td><td style="text-align: center;">98.5</td><td style="text-align: center;">21.83</td></tr></tbody></table></div><h1 id="ä¼˜åŒ–å™¨">3ã€ä¼˜åŒ–å™¨</h1><p>é™¤äº†Baselineä¸­è®¾ç½®äº†åŠ¨é‡å‚æ•°å¤–ï¼Œå…¶ä½™çš†é‡‡ç”¨é»˜è®¤å‚æ•°</p><div class="center"><table><thead><tr class="header"><th style="text-align: center;">å‚æ•°</th><th style="text-align: center;">æµ‹è¯•é›†å‡†ç¡®ç‡ï¼ˆ%ï¼‰</th><th style="text-align: center;">ç”¨æ—¶ï¼ˆsï¼‰</th></tr></thead><tbody><tr class="odd"><td style="text-align: center;">Baseline</td><td style="text-align: center;">98.4</td><td style="text-align: center;">20.40</td></tr><tr class="even"><td style="text-align: center;">Adam</td><td style="text-align: center;">95.2</td><td style="text-align: center;">20.43</td></tr><tr class="odd"><td style="text-align: center;">AdamW</td><td style="text-align: center;">97.5</td><td style="text-align: center;">20.62</td></tr><tr class="even"><td style="text-align: center;">RMSprop</td><td style="text-align: center;">97.2</td><td style="text-align: center;"><strong>20.04</strong></td></tr><tr class="odd"><td style="text-align: center;">Adagrad</td><td style="text-align: center;"><strong>98.8</strong></td><td style="text-align: center;">20.31</td></tr></tbody></table></div><h1 id="å½’ä¸€åŒ–">4ã€å½’ä¸€åŒ–</h1><h1 id="å­¦ä¹ ç‡">5ã€å­¦ä¹ ç‡</h1><h1 id="batchsize">6ã€BatchSize</h1>]]></content>
    
    
    <categories>
      
      <category>æŠ€æœ¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>é¢ç»</tag>
      
      <tag>Pytorch</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ•°ç»„</title>
    <link href="/2024/08/28/%E6%95%B0%E7%BB%84/"/>
    <url>/2024/08/28/%E6%95%B0%E7%BB%84/</url>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"><h1 id="åŒæŒ‡é’ˆ">1ã€åŒæŒ‡é’ˆ</h1><ol type="1"><li><p><a href="https://leetcode.cn/problems/squares-of-a-sorted-array/">977. Squares of a Sorted Array</a></p><p><img src="https://code-thinking.cdn.bcebos.com/gifs/977.%E6%9C%89%E5%BA%8F%E6%95%B0%E7%BB%84%E7%9A%84%E5%B9%B3%E6%96%B9.gif"></p></li></ol><h1 id="æ»‘åŠ¨çª—å£">2ã€æ»‘åŠ¨çª—å£</h1><ol type="1"><li><a href="https://leetcode.cn/problems/minimum-size-subarray-sum/">209. Minimum Size Subarray Sum</a></li></ol><h1 id="æ¨¡æ‹Ÿè¡Œä¸º">3ã€æ¨¡æ‹Ÿè¡Œä¸º</h1><ol type="1"><li><a href="https://leetcode.cn/problems/spiral-matrix-ii/">59. Spiral Matrix IIï¼šæ¨¡æ‹Ÿé¡ºæ—¶é’ˆç”»çŸ©é˜µçš„è¿‡ç¨‹</a></li></ol><h1 id="å‰ç¼€å’Œ">4ã€å‰ç¼€å’Œ</h1><p>é‡å¤åˆ©ç”¨è®¡ç®—è¿‡çš„å­æ•°ç»„ä¹‹å’Œï¼Œä»è€Œé™ä½åŒºé—´æŸ¥è¯¢éœ€è¦ç´¯åŠ è®¡ç®—çš„æ¬¡æ•°ã€‚åœ¨æ¶‰åŠè®¡ç®—åŒºé—´å’Œçš„é—®é¢˜æ—¶éå¸¸æœ‰ç”¨</p>]]></content>
    
    
    <categories>
      
      <category>æŠ€æœ¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŠ›æ‰£</tag>
      
      <tag>æ•°ç»„</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å½’ä¸€åŒ–</title>
    <link href="/2024/08/27/%E5%BD%92%E4%B8%80%E5%8C%96/"/>
    <url>/2024/08/27/%E5%BD%92%E4%B8%80%E5%8C%96/</url>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"><h1 id="batchnorm">1ã€BatchNorm</h1><h1 id="layernorm">2ã€LayerNorm</h1><p>é’ˆå¯¹ä¸€ä¸ªæ ·æœ¬æ‰€æœ‰ç‰¹å¾è®¡ç®—å‡å€¼å’Œæ–¹å·®ï¼Œç„¶åå¯¹æ ·æœ¬è¿›è¡Œå½’ä¸€åŒ–</p><p>å‡å°‘å†…éƒ¨åå˜é‡åç§»ï¼ˆInternal Covariate Shiftï¼‰ï¼š å†…éƒ¨åå˜é‡åç§»æ˜¯æŒ‡åœ¨æ·±åº¦ç¥ç»ç½‘ç»œçš„è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæ¯ä¸€å±‚è¾“å…¥çš„åˆ†å¸ƒä¼šå‘ç”Ÿå˜åŒ–ï¼Œå¯¼è‡´ç½‘ç»œçš„è®­ç»ƒå˜å¾—å›°éš¾ã€‚å±‚å½’ä¸€åŒ–é€šè¿‡å¯¹æ¯ä¸€å±‚çš„è¾“å…¥è¿›è¡Œå½’ä¸€åŒ–å¤„ç†ï¼Œå¯ä»¥å‡å°‘å†…éƒ¨åå˜é‡åç§»ï¼Œä½¿å¾—æ¯ä¸€å±‚çš„è¾“å…¥åˆ†å¸ƒæ›´åŠ ç¨³å®šã€‚ <strong>ç¨³å®šæ¢¯åº¦</strong>ï¼š å±‚å½’ä¸€åŒ–æœ‰åŠ©äºä¿æŒæ¯ä¸€å±‚è¾“å‡ºçš„å‡å€¼å’Œæ–¹å·®ç¨³å®šï¼Œä»è€Œä½¿å¾—æ¢¯åº¦çš„ä¼ æ’­æ›´åŠ ç¨³å®šã€‚è¿™æœ‰åŠ©äºå‡å°‘æ¢¯åº¦æ¶ˆå¤±æˆ–æ¢¯åº¦çˆ†ç‚¸çš„é—®é¢˜ï¼Œæé«˜æ¢¯åº¦åœ¨ç½‘ç»œä¸­çš„æµåŠ¨æ€§ï¼ŒåŠ å¿«è®­ç»ƒé€Ÿåº¦ã€‚<sup><a href="#ref1">1</a></sup></p><h1 id="instancenorm">3ã€InstanceNorm</h1><h1 id="rmsnorm">4ã€RMSNorm</h1><h1 id="å‚è€ƒ">å‚è€ƒ</h1><ol type="1"><li><span name="ref1"><a href="https://www.cnblogs.com/shine-lee/p/11989612.html">Batch Normalizationè¯¦è§£</a></span></li></ol>]]></content>
    
    
    <categories>
      
      <category>æŠ€æœ¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>é¢ç»</tag>
      
      <tag>å½’ä¸€åŒ–</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ¿€æ´»å‡½æ•°</title>
    <link href="/2024/08/26/%E6%BF%80%E6%B4%BB%E5%87%BD%E6%95%B0/"/>
    <url>/2024/08/26/%E6%BF%80%E6%B4%BB%E5%87%BD%E6%95%B0/</url>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"><h1 id="æ¿€æ´»å‡½æ•°">1ã€æ¿€æ´»å‡½æ•°</h1><ol type="1"><li><p><code>sigmoid</code>ï¼š<span class="math inline">\(\sigma(x)=\frac{1}{1+e^{-x}}\)</span></p><ul><li><p><span class="math inline">\(\rm max\{\sigma&#39;(x)\}=0.25&lt;1\)</span>ï¼Œå®¹æ˜“å‡ºç°æ¢¯åº¦æ¶ˆå¤±</p></li><li><p>è¾“å‡ºå‡å€¼ä¸ä¸º0ï¼Œå¯¼è‡´æ”¶æ•›å˜æ…¢</p><p>â€‹ <a href="https://cloud.tencent.com/developer/article/1829621">éé›¶å‡å€¼ï¼Ÿæ¿€æ´»å‡½æ•°ä¹Ÿå¤ªç¡¬æ ¸äº†</a></p><p>â€‹ <a href="https://liam.page/2018/04/17/zero-centered-active-function/">è°ˆè°ˆæ¿€æ´»å‡½æ•°ä»¥0ä¸ºä¸­å¿ƒ çš„é—®é¢˜</a></p></li></ul></li><li><p><code>ReLU</code></p></li></ol>]]></content>
    
    
    <categories>
      
      <category>æŠ€æœ¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>é¢ç»</tag>
      
      <tag>æ¿€æ´»å‡½æ•°</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Transformer</title>
    <link href="/2024/08/24/Transformer/"/>
    <url>/2024/08/24/Transformer/</url>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"><h1 id="ç»“æ„">1ã€ç»“æ„</h1><h1 id="ç‰¹ç‚¹">2ã€ç‰¹ç‚¹</h1><ol type="1"><li>æ”¯æŒå¹¶è¡Œè®¡ç®—ï¼Œæé«˜æ¨ç†é€Ÿåº¦ğŸ‘</li><li>æ•æ‰é•¿è·ç¦»ä¾èµ–å…³ç³»ğŸ‘</li><li>è®¡ç®—æˆæœ¬é«˜ğŸ‘</li><li>å¯¹åºåˆ—é•¿åº¦æ•æ„ŸğŸ‘</li></ol>]]></content>
    
    
    <categories>
      
      <category>æŠ€æœ¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>é¢ç»</tag>
      
      <tag>Transformer</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é“¾è¡¨</title>
    <link href="/2024/08/24/%E9%93%BE%E8%A1%A8/"/>
    <url>/2024/08/24/%E9%93%BE%E8%A1%A8/</url>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"><h1 id="é“¾è¡¨åˆ é™¤å¤´ç»“ç‚¹">1ã€é“¾è¡¨åˆ é™¤å¤´ç»“ç‚¹</h1><ul><li>è®¾ç½®è™šæ‹Ÿå¤´ç»“ç‚¹</li><li>å°†åŸæ¥é“¾è¡¨çš„å¤´æŒ‡é’ˆå‘åç§»åŠ¨</li></ul><ol type="1"><li><p><a href="https://leetcode.cn/problems/remove-linked-list-elements/">203. Remove Linked List Elements</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># è™šæ‹Ÿå¤´èŠ‚ç‚¹æ³•</span><br><span class="hljs-comment"># Definition for singly-linked list.</span><br><span class="hljs-comment"># class ListNode:</span><br><span class="hljs-comment">#     def __init__(self, val=0, next=None):</span><br><span class="hljs-comment">#         self.val = val</span><br><span class="hljs-comment">#         self.next = next</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">removeElements</span>(<span class="hljs-params">self, head: <span class="hljs-type">Optional</span>[ListNode], val: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-type">Optional</span>[ListNode]:<br>        <span class="hljs-comment"># åˆ›å»ºè™šæ‹Ÿå¤´éƒ¨èŠ‚ç‚¹ä»¥ç®€åŒ–åˆ é™¤è¿‡ç¨‹</span><br>        dummy_head = ListNode(<span class="hljs-built_in">next</span> = head)<br>        <br>        <span class="hljs-comment"># éå†åˆ—è¡¨å¹¶åˆ é™¤å€¼ä¸ºvalçš„èŠ‚ç‚¹</span><br>        current = dummy_head<br>        <span class="hljs-keyword">while</span> current.<span class="hljs-built_in">next</span>:<br>            <span class="hljs-keyword">if</span> current.<span class="hljs-built_in">next</span>.val == val:<br>                current.<span class="hljs-built_in">next</span> = current.<span class="hljs-built_in">next</span>.<span class="hljs-built_in">next</span><br>            <span class="hljs-keyword">else</span>:<br>                current = current.<span class="hljs-built_in">next</span><br>        <br>        <span class="hljs-keyword">return</span> dummy_head.<span class="hljs-built_in">next</span><br></code></pre></td></tr></table></figure></li></ol><h1 id="åè½¬é“¾è¡¨">2ã€åè½¬é“¾è¡¨</h1><figure><img src="https://code-thinking.cdn.bcebos.com/gifs/206.%E7%BF%BB%E8%BD%AC%E9%93%BE%E8%A1%A8.gif" alt="åè½¬é“¾è¡¨"><figcaption aria-hidden="true">åè½¬é“¾è¡¨</figcaption></figure><ol type="1"><li><p><a href="https://leetcode.cn/problems/reverse-linked-list/">206. Reverse Linked List</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># åŒæŒ‡é’ˆæ³•</span><br><span class="hljs-comment"># Definition for singly-linked list.</span><br><span class="hljs-comment"># class ListNode:</span><br><span class="hljs-comment">#     def __init__(self, val=0, next=None):</span><br><span class="hljs-comment">#         self.val = val</span><br><span class="hljs-comment">#         self.next = next</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">reverseList</span>(<span class="hljs-params">self, head: ListNode</span>) -&gt; ListNode:<br>        cur = head   <br>        pre = <span class="hljs-literal">None</span><br>        <span class="hljs-keyword">while</span> cur:<br>            temp = cur.<span class="hljs-built_in">next</span> <span class="hljs-comment"># ä¿å­˜ä¸€ä¸‹ curçš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå› ä¸ºæ¥ä¸‹æ¥è¦æ”¹å˜cur-&gt;next</span><br>            cur.<span class="hljs-built_in">next</span> = pre <span class="hljs-comment">#åè½¬</span><br>            <span class="hljs-comment">#æ›´æ–°preã€curæŒ‡é’ˆ</span><br>            pre = cur<br>            cur = temp<br>        <span class="hljs-keyword">return</span> pre<br></code></pre></td></tr></table></figure></li></ol><h1 id="å¿«æ…¢æŒ‡é’ˆåˆ é™¤é“¾è¡¨å€’æ•°ç¬¬nä¸ªèŠ‚ç‚¹">3ã€å¿«æ…¢æŒ‡é’ˆåˆ é™¤é“¾è¡¨å€’æ•°ç¬¬nä¸ªèŠ‚ç‚¹</h1><ol type="1"><li><p><a href="https://leetcode.cn/problems/remove-nth-node-from-end-of-list/">19. Remove Nth Node From End of List</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># Definition for singly-linked list.</span><br><span class="hljs-comment"># class ListNode:</span><br><span class="hljs-comment">#     def __init__(self, val=0, next=None):</span><br><span class="hljs-comment">#         self.val = val</span><br><span class="hljs-comment">#         self.next = next</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">removeNthFromEnd</span>(<span class="hljs-params">self, head: ListNode, n: <span class="hljs-built_in">int</span></span>) -&gt; ListNode:<br>        <span class="hljs-comment"># åˆ›å»ºä¸€ä¸ªè™šæ‹ŸèŠ‚ç‚¹ï¼Œå¹¶å°†å…¶ä¸‹ä¸€ä¸ªæŒ‡é’ˆè®¾ç½®ä¸ºé“¾è¡¨çš„å¤´éƒ¨</span><br>        dummy_head = ListNode(<span class="hljs-number">0</span>, head)<br>        <br>        <span class="hljs-comment"># åˆ›å»ºä¸¤ä¸ªæŒ‡é’ˆï¼Œæ…¢æŒ‡é’ˆå’Œå¿«æŒ‡é’ˆï¼Œå¹¶å°†å®ƒä»¬åˆå§‹åŒ–ä¸ºè™šæ‹ŸèŠ‚ç‚¹</span><br>        slow = fast = dummy_head<br>        <br>        <span class="hljs-comment"># å¿«æŒ‡é’ˆæ¯”æ…¢æŒ‡é’ˆå¿« n+1 æ­¥</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">1</span>):<br>            fast = fast.<span class="hljs-built_in">next</span><br>        <br>        <span class="hljs-comment"># ç§»åŠ¨ä¸¤ä¸ªæŒ‡é’ˆï¼Œç›´åˆ°å¿«é€ŸæŒ‡é’ˆåˆ°è¾¾é“¾è¡¨çš„æœ«å°¾</span><br>        <span class="hljs-keyword">while</span> fast:<br>            slow = slow.<span class="hljs-built_in">next</span><br>            fast = fast.<span class="hljs-built_in">next</span><br>        <br>        <span class="hljs-comment"># é€šè¿‡æ›´æ–°ç¬¬ (n-1) ä¸ªèŠ‚ç‚¹çš„ next æŒ‡é’ˆåˆ é™¤ç¬¬ n ä¸ªèŠ‚ç‚¹</span><br>        slow.<span class="hljs-built_in">next</span> = slow.<span class="hljs-built_in">next</span>.<span class="hljs-built_in">next</span><br>        <br>        <span class="hljs-keyword">return</span> dummy_head.<span class="hljs-built_in">next</span><br></code></pre></td></tr></table></figure></li></ol><h1 id="ç¯å½¢é“¾è¡¨">4ã€ç¯å½¢é“¾è¡¨</h1><ol type="1"><li><p><a href="https://leetcode.cn/problems/linked-list-cycle-ii/">142. Linked List Cycle II</a></p><p>è¿™ä¸ªé¢˜ç›®é¦–å…ˆè¦åˆ©ç”¨å¿«æ…¢æŒ‡é’ˆï¼ˆæ­¥é•¿åˆ†åˆ«ä¸º1ã€2ï¼‰æ±‚å‡ºä¸€ä¸ªåœˆçš„é•¿åº¦æ˜¯å¤šå°‘ï¼Œç„¶ååˆ©ç”¨åˆ é™¤é“¾è¡¨ä¸­å€’æ•°ç¬¬nä¸ªèŠ‚ç‚¹ä¸­çš„æ€æƒ³å†æ¬¡ä½¿ç”¨å¿«æ…¢æŒ‡é’ˆï¼ˆä¸€ä¸ªæŒ‡é’ˆé¢†å…ˆå¤´æŒ‡é’ˆä¸€ä¸ªåœˆçš„é•¿åº¦ï¼‰æ±‚å‡ºå…¥åœˆèŠ‚ç‚¹ï¼›ä¸‹å›¾ä¸ºå¦ä¸€ç§åšæ³•ï¼šä¸Š</p><figure><img src="https://code-thinking.cdn.bcebos.com/gifs/142.%E7%8E%AF%E5%BD%A2%E9%93%BE%E8%A1%A8II%EF%BC%88%E6%B1%82%E5%85%A5%E5%8F%A3%EF%BC%89.gif" alt="å¦ä¸€ç§åšæ³•"><figcaption aria-hidden="true">å¦ä¸€ç§åšæ³•</figcaption></figure></li></ol>]]></content>
    
    
    <categories>
      
      <category>æŠ€æœ¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŠ›æ‰£</tag>
      
      <tag>é“¾è¡¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>TSCILè®ºæ–‡ç¬”è®°Â·I</title>
    <link href="/2024/08/17/TSCIL%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0%C2%B7I/"/>
    <url>/2024/08/17/TSCIL%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0%C2%B7I/</url>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"><h1 id="é˜…è¯»è®ºæ–‡">ã€‡ã€é˜…è¯»è®ºæ–‡</h1><ol type="1"><li><a href="https://arxiv.org/abs/1904.07734">å¢é‡å­¦ä¹ çš„ä¸‰ç§åœºæ™¯åŠæ–¹æ³•ï¼šThree scenarios for continual learning</a></li><li><a href="https://arxiv.org/abs/2112.08654">é¢„è®­ç»ƒæ¨¡å‹å›¾åƒç±»å¢é‡å­¦ä¹ ï¼šLearning to Prompt for Continual Learning</a></li><li><a href="https://arxiv.org/abs/2402.12035">æ—¶é—´åºåˆ—ç±»å¢é‡å­¦ä¹ çš„åŸºå‡†ï¼šClass-incremental Learning for Time Series:Benchmark and Evaluation</a></li><li><a href="https://arxiv.org/abs/2204.04799">åŒæç¤ºå¢é‡å­¦ä¹ ï¼šDualPrompt: Complementary Prompting for Rehearsal-free Continual Learning</a></li><li><a href="https://arxiv.org/abs/2402.03885">æ—¶é—´åºåˆ—å¤§æ¨¡å‹ï¼šMOMENT: A Family of Open Time-series Foundation Models</a></li><li><a href="https://arxiv.org/abs/2403.20317">å·ç§¯æç¤ºï¼šConvolutional Prompting meets Language Models for Continual Learning</a></li></ol><h1 id="ä¸€ç›¸å…³å·¥ä½œ">ä¸€ã€ç›¸å…³å·¥ä½œ</h1><h2 id="å¢é‡å­¦ä¹ çš„ä¸‰ç§åœºæ™¯åŠæ–¹æ³•">1. å¢é‡å­¦ä¹ çš„ä¸‰ç§åœºæ™¯åŠæ–¹æ³•</h2><h3 id="å®éªŒæ–¹æ³•">1.1 å®éªŒæ–¹æ³•</h3><ol type="1"><li>æ­£åˆ™åŒ–ï¼ˆSIã€EWCï¼‰</li><li>é‡æ”¾ï¼ˆReplayï¼‰<ol type="1"><li>ç”¨ä¹‹å‰æ¨¡å‹å¯¹å½“å‰ä»»åŠ¡çš„Inputè¿›è¡Œæ ‡æ³¨ç”Ÿæˆä¼ªæ•°æ®ï¼ˆLwFï¼‰</li><li>ç”Ÿæˆæ–°æ•°æ®ï¼ˆDGRã€DGR+distillï¼‰</li><li>åŸå§‹æ•°æ®é‡ç°ï¼ˆå¯èƒ½ä¼šæœ‰éšç§æˆ–å†…å­˜é—®é¢˜ï¼‰</li></ol></li><li>Exemplarsï¼ˆç‰¹å¾æå–+æœ€è¿‘ç±»å‡å€¼+é‡æ”¾ï¼šiCaRLï¼‰</li></ol><h3 id="å®éªŒç»“æœ">1.2 å®éªŒç»“æœ</h3><figure><img src="/2024/08/17/TSCIL%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0%C2%B7I/MNISTç»“æœ.png" alt="å®éªŒç»“æœå¯¹æ¯”ï¼šæ­£åˆ™åŒ–çš„æ•ˆæœæ™®éä¸å¤ªè¡Œ"><figcaption aria-hidden="true">å®éªŒç»“æœå¯¹æ¯”ï¼šæ­£åˆ™åŒ–çš„æ•ˆæœæ™®éä¸å¤ªè¡Œ</figcaption></figure><h2 id="é¢„è®­ç»ƒæ¨¡å‹å›¾åƒç±»å¢é‡å­¦ä¹ ">2. é¢„è®­ç»ƒæ¨¡å‹å›¾åƒç±»å¢é‡å­¦ä¹ </h2><h3 id="å®éªŒæ–¹æ³•-1">2.1 å®éªŒæ–¹æ³•</h3><ol type="1"><li>è®¾Inputä¸º<span class="math inline">\(x\)</span>ï¼Œé€šè¿‡<span class="math inline">\(q(x)\)</span>è¿›è¡Œæ˜ å°„</li><li>è®¡ç®—<span class="math inline">\(q(x)\)</span>ä¸Keyçš„ä½™å¼¦ç›¸ä¼¼åº¦å¹¶é€‰æ‹©TopNï¼ˆåŒä¸€Promptè¢«é€‰æ‹©çš„æ¬¡æ•°è¶Šå¤šï¼Œä¸‹æ¬¡è¢«é€‰æ‹©çš„æ¦‚ç‡è¶Šå°ï¼‰</li><li>å°†TopNå‘é‡ï¼Œä»¥åŠè¿›å…¥Embeddingå±‚çš„Inputæ‹¼æ¥ï¼Œå¹¶æ”¾å…¥é¢„è®­ç»ƒæ¨¡å‹</li></ol><figure><img src="/2024/08/17/TSCIL%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0%C2%B7I/L2P.png" alt="L2P"><figcaption aria-hidden="true">L2P</figcaption></figure><h4 id="vit">2.1.1 ViT</h4><p>åœ¨ç»†è¯»è®ºæ–‡æ—¶éœ€è¦ä¸€äº›ViTçš„çŸ¥è¯†ï¼Œäºæ˜¯æ‰¾åˆ°äº†è¿™ç¯‡åšå®¢ï¼š<a href="https://blog.csdn.net/MengYa_Dream/article/details/126600748">ViTçš„cls tokenä½œç”¨</a></p><ol type="1"><li>è®ºæ–‡ä¸­å‡è®¾è¾“å…¥çš„2Då›¾åƒ<span class="math inline">\(x \in \mathbb{R}^{H \times W \times C}\)</span>ä¸­<span class="math inline">\(H\)</span>ï¼Œ<span class="math inline">\(W\)</span>ï¼Œ<span class="math inline">\(C\)</span>åˆ†åˆ«ä»£è¡¨é«˜åº¦ï¼Œå®½åº¦å’Œé€šé“æ•°</li><li><span class="math inline">\(f=f_r \circ f_e\)</span>æ˜¯ä¸€ä¸ªå¤åˆå‡½æ•°ï¼ŒæŒ‡çš„æ˜¯å°†è¾“å…¥embeddingåé€å…¥è‡ªæ³¨æ„åŠ›å±‚çš„ç»“æœ</li><li>ViTä¸­ï¼Œå›¾åƒéœ€è¦åˆ‡åˆ†ä¸ºè‹¥å¹²patchï¼›åœ¨è¿™é‡Œflattened 2D patches <span class="math inline">\(x_p \in \mathbb{R}^{L \times (S^2 \cdot C)}\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(L\)</span>ä¸ºpatchesä¸ªæ•°ï¼Œ<span class="math inline">\(S\)</span>ä¸ºpatch size</li><li>ä¸ºäº†ç®€åŒ–è¡¨ç¤ºï¼Œ<span class="math inline">\(x_p\)</span>çš„ç¬¬ä¸€ä¸ªtokenè¢«å½“åšæ˜¯<code>[class token]</code></li><li>embedding layerçš„ä½œç”¨<span class="math inline">\(f_e:\mathbb{R}^{L \times (S^2 \cdot C)} \rightarrow \mathbb{R}^{L \times D}\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(D\)</span>æ˜¯åµŒå…¥ç»´åº¦</li><li>ä¸€ä¸ªPromptå¯ä»¥çœ‹ä½œæ˜¯$P_e^{L_p D} <span class="math inline">\(ï¼Œå…¶ä¸­\)</span>L_p$æ˜¯Promptçš„é•¿åº¦</li><li>å°†Promptå’ŒInputæ‹¼æ¥èµ·æ¥å¯ä»¥å¾—åˆ°<span class="math inline">\(x_p=[P_e;x_e]\)</span></li><li>é€å…¥é¢„è®­ç»ƒæ¨¡å‹åï¼Œå³<span class="math inline">\(f=f_r(x_p)\)</span></li></ol><h4 id="prompt-pool">2.1.2 Prompt Pool</h4><p>ä¸ºä»€ä¹ˆè¦é‡‡ç”¨Poolçš„åŸå› æœ‰ä¸‰ï¼š</p><ol type="1"><li>åœ¨æ¨ç†çš„æ—¶å€™task identityæ˜¯ä¸å¾—è€ŒçŸ¥çš„ï¼Œå› æ­¤ä¸ºæ¯ä¸ªtaskè®¾ç½®ä¸€ä¸ªpromptæ˜¯ä¸å¯è¡Œçš„</li><li>å³ä½¿æ¨ç†æ—¶ä¸Šè¿°ä¿¡æ¯å¯ä»¥å¾—çŸ¥ï¼Œé‚£ä¹ˆtask-independent promptå¯èƒ½é˜»æ­¢äº†ç›¸ä¼¼ä»»åŠ¡é—´çš„ä¿¡æ¯å…±äº«</li><li>å¦‚æœåªç”¨ä¸€ä¸ªpromptï¼Œåˆ™ä¼šé€ æˆç¾éš¾æ€§é—å¿˜</li></ol><p>äºæ˜¯å®šä¹‰Prompté›†åˆï¼š<span class="math inline">\(P = \{P_1, P_2, \cdots , P_M \}\)</span>ï¼Œåˆ™ViTçš„è¾“å…¥ä¸ºï¼š<span class="math inline">\(x_p = [P_{s_1} ; \cdots ; P_{s_N} ; x_e], 1 â‰¤ N â‰¤ M\)</span></p><p>Prompt Poolä¸­å…¶å®æ˜¯Key-Value pairï¼š<span class="math inline">\(\{(k_1, P_1), (k_2, P_2), \cdots , (k_M , P_M )\},k_i \in \mathbb{R}^{D_k}\)</span></p><div class="note note-info">            <p>æ ¹æ®è®ºæ–‡æ¥çœ‹ï¼ŒMä¸ºæ‰€æœ‰Prompt çš„æ•°é‡ï¼Œæ˜¯ä¸€ä¸ªå¯ä»¥å®šä¹‰çš„å‚æ•°</p>          </div><h4 id="prompt-query">2.1.3 Prompt Query</h4><ol type="1"><li>Queryåº”ä»…è·Ÿè¾“å…¥å®ä¾‹æœ‰å…³ï¼Œå¹¶ä¸”æ²¡æœ‰å¯å­¦ä¹ çš„å‚æ•°ï¼›å®šä¹‰Query Functionï¼š<span class="math inline">\(q : \mathbb{R}^{H\times W \times C} â†’ \mathbb{R}^{D_k}\)</span></li><li>ä½œè€…ç”¨äº†ViTä½œä¸ºfeature extractorï¼š<span class="math inline">\(q(x) = f (x)[0,:]\)</span>ï¼Œå…¶å®å°±æ˜¯<code>[class token]</code>å¯¹åº”çš„å‘é‡<ul><li>åŒæ—¶ï¼Œä½œè€…æŒ‡å‡ºç”¨ConvNetä¹Ÿæ˜¯å¯è¡Œçš„</li></ul></li><li>å®šä¹‰ç›¸ä¼¼åº¦è®¡ç®—å‡½æ•°<span class="math inline">\(\gamma : \mathbb{R}^{D_k} \times \mathbb{R}^{D_k} \rightarrow \mathbb{R}\)</span>ï¼Œä½œè€…å‘ç°ä½™å¼¦ç›¸ä¼¼åº¦å°±å¾ˆå¥½</li><li>é—®é¢˜ç®€åŒ–ä¸º<span class="math inline">\(K_x = \mathop{argmin}\limits_{\{s_i\}^N_{i=1}\in[1,M ]} \sum\limits_{i=1}^N \gamma (q(x), k_{s_i} )\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(K_x\)</span>æ˜¯æ‰€æœ‰Keyçš„ä¸€ä¸ªå­é›†<ul><li>ä¸ºäº†è®©æ¯ä¸ªPromptéƒ½æœ‰æœºä¼šè¢«å¼•ç”¨ï¼Œè®­ç»ƒæ—¶æ”¹å†™ä¸º<span class="math inline">\(K_x = \mathop{argmin}\limits_{\{s_i\}^N_{i=1}\in[1,M ]} \sum\limits_{i=1}^N \gamma (q(x), k_{s_i} )\cdot h_{s_i}\)</span></li></ul></li></ol><h4 id="loss-function">2.1.4 Loss Function</h4><p><span class="math display">\[\mathop{\rm min} \limits_{P,K,\phi} \mathcal{L}(g_{\phi}(f^{avg}_r (x_p)), y) + \lambda\sum\limits_{K_x}  \gamma (q(x), k_{s_i} ),\quad s.t. K_xåœ¨2.1.3ä¸­å·²ç»å¾—åˆ°\]</span></p><h3 id="å®éªŒç»“æœ-1">2.2 å®éªŒç»“æœ</h3><p><img src="/2024/08/17/TSCIL%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0%C2%B7I/CIFAR.png"></p><h2 id="æ—¶é—´åºåˆ—ç±»å¢é‡å­¦ä¹ çš„åŸºå‡†">3. æ—¶é—´åºåˆ—ç±»å¢é‡å­¦ä¹ çš„åŸºå‡†</h2><h3 id="å®éªŒæ–¹æ³•-2">3.1 å®éªŒæ–¹æ³•</h3><h4 id="æ­£åˆ™åŒ–">3.1.1 æ­£åˆ™åŒ–</h4><p>åŸºäºæ­£åˆ™åŒ–çš„æ–¹æ³•ï¼ˆLwFã€MASã€<span class="math inline">\(DT^2W\)</span>ï¼‰åªåœ¨UCI-HARå’ŒUWaveç­‰ä»»åŠ¡è¾ƒå°‘çš„ç®€å•æ•°æ®é›†ä¸­è¡¨ç°å‡ºæ˜æ˜¾çš„ä¼˜åŠ¿</p><h4 id="å½’ä¸€åŒ–bn-vs-ln">3.1.2 å½’ä¸€åŒ–ï¼šBN vs LN</h4><p>åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ä½¿ç”¨LNçš„æ•ˆæœè¦æ¯”BNæ›´å¥½</p><figure><img src="/2024/08/17/TSCIL%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0%C2%B7I/Norm.png" alt="Norm"><figcaption aria-hidden="true">Norm</figcaption></figure><h4 id="rehearsal-baseder-vs-gr">3.1.3 Rehearsal-basedï¼šER vs GR</h4><p>GRåœ¨ç®€å•æ•°æ®ä¸Šè¾ƒå¥½ï¼Œç”šè‡³å¥½è¿‡ERï¼Œå¤æ‚æ•°æ®ä¸Šè¡¨ç°ä¸ä½³ï¼›å¯èƒ½æ˜¯å› ä¸ºéš¾ä»¥ç”Ÿæˆå¤æ‚æ•°æ®ï¼Œä»¥åŠæ— æ³•æ§åˆ¶ç”Ÿæˆçš„ç±»åˆ«</p><h4 id="meomory-budgetåœ¨bnå’Œlnä¸Šçš„å·®å¼‚">3.1.4 Meomory budgetåœ¨BNå’ŒLNä¸Šçš„å·®å¼‚</h4><p><img src="/2024/08/17/TSCIL%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0%C2%B7I/memory.png"></p><ul><li>åŸºäºERçš„æ–¹æ³•é€šå¸¸æ€§èƒ½ä¼šéšç€Memory budgetçš„å¢å¤§è€Œæé«˜ï¼Œåˆ°è¾¾ä¸€å®šç¨‹åº¦ä¼šè¶‹äºé¥±å’Œ</li><li>åœ¨å†…å­˜è¶³å¤Ÿæ—¶ï¼ŒBNåœ¨é™¤ASERçš„æ–¹æ³•éƒ½ä¸Offlineæœ‰å¾ˆå¤§å·®å¼‚ï¼Œå› ä¸ºéšç€ä»»åŠ¡æ•°é‡å¢åŠ <span class="math inline">\(B_{M}\)</span>ä¸­æ—§æ ·æœ¬æ¯”ä¾‹ä¼šå‡å°‘ï¼›LNåˆ™æ¥è¿‘Offline</li></ul><h4 id="åˆ†ç±»å™¨çš„é€‰æ‹©">3.1.5 åˆ†ç±»å™¨çš„é€‰æ‹©</h4><p>åˆ†ç±»å™¨é€‰æ‹©å–å†³äºæ–¹æ³•ä¸æ•°æ®é›†ï¼Œåœ¨ERä¸Šçš„åŒºåˆ«å¹¶ä¸æ˜æ˜¾</p><h2 id="åŒæç¤ºå¢é‡å­¦ä¹ ">4. åŒæç¤ºå¢é‡å­¦ä¹ </h2><h3 id="å®éªŒæ–¹æ³•-3">4.1 å®éªŒæ–¹æ³•</h3><p><img src="/2024/08/17/TSCIL%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0%C2%B7I/dual.png"></p><ol type="1"><li>G-Promptï¼ˆå”¯ä¸€ï¼Œå­¦ä¹ ä»»åŠ¡çš„ä¸€èˆ¬æ€§ï¼‰å’ŒE-Promptï¼ˆæ¯ä¸ªä»»åŠ¡å¯¹åº”ä¸€ä¸ªï¼Œå­¦ä¹ ä»»åŠ¡çš„ç‰¹æ®Šæ€§ï¼‰</li><li>åˆ©ç”¨Prefix-Tuningï¼ˆæ•ˆæœç›¸æ¯”Prompt-Tuningæ›´å¥½ï¼Œä¸”æœªæ”¹å˜è¾“å…¥ç»´åº¦ï¼‰å°†<span class="math inline">\(p\)</span>åˆ†è§£æˆ<span class="math inline">\(p_{K},p_{V}\in \mathbb R^{L_{p}/2\times D}\)</span>ï¼Œå¹¶ä¸”åŠ åˆ°å¤šå¤´è‡ªæ³¨æ„åŠ›å±‚ä¸­ï¼š<span class="math inline">\(f^{\rm Pre-T}_{\rm prompt}(p,h)={\rm MSA}(h_{Q},[p_{k};h_{K}],[p_{v};h_{V}])\)</span></li><li>è®­ç»ƒæ—¶ï¼Œåˆ©ç”¨<span class="math inline">\(\mathcal L_{\rm match}(x,k_t)=\gamma(q(x),k_t) ,x \in \mathcal D_t\)</span>æ›´æ–°<span class="math inline">\(k_t\)</span>ï¼Œå°†G-Promptå’ŒE-Promptåˆ†åˆ«åŠ åˆ°æŸäº›MSAä¸­</li><li>æ¨ç†æ—¶ï¼ŒInputé€šè¿‡Query functionæ˜ å°„å¹¶é€‰æ‹©æœ€ç›¸ä¼¼çš„E-Prompt</li></ol><h3 id="å®éªŒç»“æœ-2">4.2 å®éªŒç»“æœ</h3><p><img src="/2024/08/17/TSCIL%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0%C2%B7I/dual_res.png"></p><h2 id="æ—¶é—´åºåˆ—å¤§æ¨¡å‹">5. æ—¶é—´åºåˆ—å¤§æ¨¡å‹</h2><div class="group-image-container"><div class="group-image-row"><div class="group-image-wrap"><img src="/2024/08/17/TSCIL%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0%C2%B7I/pile.png"></div><div class="group-image-wrap"><img src="/2024/08/17/TSCIL%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0%C2%B7I/moment_radar.png"></div></div></div><h3 id="time-series-pile">5.1 Time-series Pile</h3><h3 id="æ¨¡å‹ç»“æ„">5.2 æ¨¡å‹ç»“æ„</h3><p><img src="/2024/08/17/TSCIL%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0%C2%B7I/moment.png"></p><ol type="1"><li>å°†æ—¶é—´åºåˆ—æ•°æ®åˆ†ä¸ºä¸é‡å çš„å›ºå®šé•¿åº¦åºåˆ—patchesï¼ˆå‡å°‘å†…å­˜å ç”¨å’Œè®¡ç®—å¤æ‚åº¦ï¼‰ï¼Œæ˜ å°„åˆ°Dç»´å‘é‡</li><li>åœ¨é¢„è®­ç»ƒæœŸé—´ï¼Œé€šè¿‡ä½¿ç”¨ç‰¹æ®Šçš„æ©ç åµŒå…¥[MASK]æ¥æ›¿æ¢ patchesåµŒå…¥ï¼Œç›®æ ‡æ˜¯å­¦ä¹  patches åµŒå…¥</li><li>è¿™äº›åµŒå…¥å¯ä»¥ä½¿ç”¨è½»é‡çº§çš„é‡å»ºå¤´ï¼Œè€Œä¸æ˜¯ä¸ç¼–ç å™¨ç›¸åŒå¤§å°çš„è§£ç å™¨ï¼Œæ¥é‡å»ºè¾“å…¥æ—¶é—´åºåˆ—ã€‚ä»¥ä¾¿åœ¨ä¿æŒç¼–ç å™¨çš„å¤§éƒ¨åˆ†å‚æ•°å’Œé«˜çº§ç‰¹å¾ä¸å˜çš„åŒæ—¶ï¼Œå¯¹æœ‰é™æ•°é‡çš„å¯è®­ç»ƒå‚æ•°è¿›è¡Œä»»åŠ¡ç‰¹å®šçš„å¾®è°ƒï¼Œä»è€Œè¿›è¡Œå¿…è¦çš„æ¶æ„ä¿®æ”¹ã€‚</li></ol><h3 id="å®éªŒç»“æœ-3">5.3 å®éªŒç»“æœ</h3><p><img src="/2024/08/17/TSCIL%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0%C2%B7I/moment_res1.png"></p><figure><img src="/2024/08/17/TSCIL%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0%C2%B7I/moment_res2.png" alt="é›¶æ ·æœ¬æ³›åŒ–èƒ½åŠ›"><figcaption aria-hidden="true">é›¶æ ·æœ¬æ³›åŒ–èƒ½åŠ›</figcaption></figure><h2 id="å·ç§¯æç¤º">6. å·ç§¯æç¤º</h2><h3 id="å®éªŒæ–¹æ³•-4">6.1 å®éªŒæ–¹æ³•</h3><p><img src="/2024/08/17/TSCIL%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0%C2%B7I/å·ç§¯.png"></p><ol type="1"><li>GPT-3ç»™å‡ºæ¯ä¸ªä»»åŠ¡ä¸­ç±»åˆ«çš„visual featuresï¼Œåˆ©ç”¨BERTè¿›è¡Œword embedding</li><li>æ ¹æ®å½“å‰ä»»åŠ¡<span class="math inline">\(t\)</span>å’Œä¹‹å‰ä»»åŠ¡ä¸­ç±»åˆ«çš„visual featuresè®¡ç®—ç›¸ä¼¼åº¦ï¼Œå–æœ€å¤§ç›¸ä¼¼åº¦çš„å¹³å‡å€¼ä¸º<span class="math inline">\(sim_{t}\)</span></li><li><span class="math inline">\(J_{max}\)</span>ä¸ºæ¯ä¸ªä»»åŠ¡çš„æœ€å¤§Prompt Generatoræ•°é‡ï¼Œäºæ˜¯$J_{t}=(1-sim_{t}) J_{max} $</li><li>è¾“å…¥å›¾åƒï¼Œ<span class="math inline">\(PN_{\phi}\)</span>ï¼ˆå”¯ä¸€ï¼‰å°†å‰ä¸€å±‚çš„<code>[CLS]</code>æŠ•å½±åˆ°å’ŒPrompt Keysï¼ˆå…±Mä¸ªï¼Œå”¯ä¸€ï¼‰ ç›¸åŒç»´åº¦å¹¶è®¡ç®—ä½™å¼¦ç›¸ä¼¼åº¦å¾—åˆ°<span class="math inline">\(s_{i}\)</span></li><li>å¯¹äºæ¯ä¸€å±‚ã€æ¯ä¸€ä¸ªå¤´æœ‰ä¸€å¥—Shared Embeddingï¼ˆå”¯ä¸€ï¼‰å’Œä¸€å¥—Prompt Generatorï¼ˆMä¸ªï¼Œå¯¹åº”äºPrompt Keysï¼›è®­ç»ƒæ—¶ä¹‹å‰ä»»åŠ¡å¯¹åº”çš„Generatorä¼šè¢«å†»ç»“ï¼‰ï¼›å¯¹äº<span class="math inline">\(G^K_{h,l,m}\)</span>ã€<span class="math inline">\(G^V_{h,l,m}\)</span>åˆ†åˆ«ä¸<span class="math inline">\(SE^{K}_{l,h}\)</span>ï¼Œ<span class="math inline">\(SE^{V}_{l,h}\)</span>è¿›è¡Œå·ç§¯åï¼Œå’Œ<span class="math inline">\(s_{i}\)</span>ç›¸ä¹˜æ±‚å’Œï¼Œå°†ç»“æœconcatåˆ°ä¸‹ä¸€å±‚ï¼š<span class="math inline">\(P_{l+1}^{K}=\sum\limits_{m=1}^{M}s_{l,m}PC^{K}_{l,h,m}\)</span>ï¼Œ<span class="math inline">\(P_{l+1}^{V}=\sum\limits_{m=1}^{M}s_{l,m}PC^{V}_{l,h,m}\)</span></li></ol><figure><img src="/2024/08/17/TSCIL%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0%C2%B7I/ç›¸ä¼¼ç±»åˆ«.png" alt="æ ¹æ®visual featuresè®¡ç®—ç›¸ä¼¼åº¦"><figcaption aria-hidden="true">æ ¹æ®visual featuresè®¡ç®—ç›¸ä¼¼åº¦</figcaption></figure><h3 id="å®éªŒç»“æœ-4">6.2 å®éªŒç»“æœ</h3><p><img src="/2024/08/17/TSCIL%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0%C2%B7I/con_cifar100.png"></p><p><img src="/2024/08/17/TSCIL%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0%C2%B7I/con_imagenet.png"></p><h1 id="äºŒl2p">äºŒã€L2P</h1><h2 id="è¸©å‘">1. è¸©å‘</h2><p>åœ¨æœåŠ¡å™¨ä¸Šéƒ¨ç½²ä¹‹åï¼ŒGithubä¸Šæåˆ°æ²¡æœ‰CIFAR-100çš„è¯ï¼Œåœ¨<code>datasets.py</code>æ›´æ”¹å¦‚ä¸‹å­—æ®µï¼š</p><figure><img src="/2024/08/17/TSCIL%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0%C2%B7I/æ•™ç¨‹.png" alt="Githubä¸Šçš„æ•™ç¨‹"><figcaption aria-hidden="true">Githubä¸Šçš„æ•™ç¨‹</figcaption></figure><p>ä½†å…¶å®ä¸ç”¨æ”¹çš„ï¼Œæœ¬æ¥å°±æ˜¯<code>True</code></p><figure><img src="/2024/08/17/TSCIL%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0%C2%B7I/æºç 1.png" alt="datasets.py"><figcaption aria-hidden="true">datasets.py</figcaption></figure><p>ä¸è¿‡åœ¨è¿è¡Œçš„æ—¶å€™ä¼šæŠ¥è¿™ä¸ªé”™ï¼š</p><figure><img src="/2024/08/17/TSCIL%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0%C2%B7I/æŠ¥é”™.png" alt="æŠ¥é”™è¯´æ²¡æœ‰cifar100_12pè¿™ä¸ªè·¯å¾„"><figcaption aria-hidden="true">æŠ¥é”™è¯´æ²¡æœ‰cifar100_12pè¿™ä¸ªè·¯å¾„</figcaption></figure><p>åæ¥æ‰¾åˆ°äº†ä¸€ä¸ªè„šæœ¬æ–‡ä»¶<code>train_cifar100_l2p.sh</code>æ‰§è¡Œï¼Œä½†æœ¬åœ°å¹¶æ²¡æœ‰<code>local_datasets</code>è·¯å¾„ï¼š</p><p><img src="/2024/08/17/TSCIL%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0%C2%B7I/è·¯å¾„.png"></p><p>è¿™ä¸ªæŠ¥é”™ä¸Šé¢æåˆ°ï¼Œè¿™ä¸ªæ•°æ®é›†æ˜¯åœ¨<code>torchvision</code>é‡Œé¢<code>cifar.py</code>ä¸‹è½½çš„ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">[rank0]:   File <span class="hljs-string">&quot;/home/eee/zym/l2p-pytorch/datasets.py&quot;</span>, line <span class="hljs-number">107</span>, <span class="hljs-keyword">in</span> get_dataset<br>[rank0]:   dataset_train = datasets.CIFAR100(args.data_path, train=<span class="hljs-literal">True</span>, download=<span class="hljs-literal">True</span>, transform=transform_train)<br>[rank0]:   File <span class="hljs-string">&quot;/home/eee/anaconda3/envs/zym/lib/python3.8/site-packages/torchvision/datasets/cifar.py&quot;</span>, line <span class="hljs-number">66</span>, <span class="hljs-keyword">in</span> __init__<br>[rank0]:     <span class="hljs-variable language_">self</span>.download()<br></code></pre></td></tr></table></figure><p>æ–°å»ºäº†<code>local_datasets</code>åè¿è¡Œè„šæœ¬æ–‡ä»¶ï¼Œè¿˜æ˜¯æŠ¥é”™ï¼›æœ€åå‘ç°è„šæœ¬è·¯å¾„å†™çš„æœ‰é—®é¢˜ï¼Œæ”¹æˆä¸‹é¢å³å¯ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">--data-path ./local_datasets/ \<br></code></pre></td></tr></table></figure><h2 id="åˆ†æ">2. åˆ†æ</h2><h3 id="ä»£ç ç»“æ„">2.1 ä»£ç ç»“æ„</h3><figure><img src="/2024/08/17/TSCIL%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0%C2%B7I/ç»“æ„.png" alt="ä»£ç ç»“æ„"><figcaption aria-hidden="true">ä»£ç ç»“æ„</figcaption></figure><p>å…³äºä¸ºä»€ä¹ˆè¦å‡ºç°<code>original_model</code>å’Œ<code>model</code>ï¼Œæ˜¯å› ä¸ºä½œè€…åœ¨è¿™é‡Œåšäº†æ¶ˆèå®éªŒï¼Œå¾®è°ƒäº†modelä¸­çš„éƒ¨åˆ†å‚æ•°ã€‚ä¸è¿‡ä»ç»“æœæ¥çœ‹ï¼Œå¹¶æ²¡æœ‰æ¯”åŸå§‹è®ºæ–‡çš„è¦å¥½ã€‚</p><p><img src="/2024/08/17/TSCIL%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0%C2%B7I/å†»ç»“.png"></p><h3 id="è¿è¡Œç»“æœ">2.2 è¿è¡Œç»“æœ</h3><p>æ³¨æ„åˆ°Losså‡ºç°äº†è´Ÿå€¼ï¼Œæ˜¯å› ä¸ºé‡‡ç”¨çš„å¤šå…ƒäº¤å‰ç†µæŸå¤±å‡½æ•°ã€‚</p><p><img src="/2024/08/17/TSCIL%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0%C2%B7I/loss.png"></p><h1 id="ä¸‰åˆæ­¥è®¾è®¡">ä¸‰ã€åˆæ­¥è®¾è®¡</h1><p><img src="/2024/08/17/TSCIL%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0%C2%B7I/æµç¨‹.png"></p>]]></content>
    
    
    <categories>
      
      <category>æŠ€æœ¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è®ºæ–‡</tag>
      
      <tag>ç±»å¢é‡å­¦ä¹ </tag>
      
      <tag>å¾®è°ƒ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BIGAI1-åŸºäºLangchainæ„å»ºç”¨äºæ•°æ®ç”ŸæˆAgent</title>
    <link href="/2024/08/06/%E5%9F%BA%E4%BA%8ELangchain%E6%9E%84%E5%BB%BA%E7%94%A8%E4%BA%8E%E6%95%B0%E6%8D%AE%E7%94%9F%E6%88%90Agent/"/>
    <url>/2024/08/06/%E5%9F%BA%E4%BA%8ELangchain%E6%9E%84%E5%BB%BA%E7%94%A8%E4%BA%8E%E6%95%B0%E6%8D%AE%E7%94%9F%E6%88%90Agent/</url>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"><p>ç±»ä¼¼çš„æ–‡ç« å·²ç»åœ¨<a href="https://blog.csdn.net/sersama/article/details/139179060?spm=1001.2014.3001.5502">CSDN</a>å‘å¸ƒè¿‡äº†ï¼Œåœ¨è¿™é‡Œè¿›è¡Œç®€å•æ€»ç»“ã€‚</p><h1 id="èƒŒæ™¯">èƒŒæ™¯</h1>]]></content>
    
    
    <categories>
      
      <category>æŠ€æœ¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å®ä¹ </tag>
      
      <tag>BIGAI</tag>
      
      <tag>æ•°æ®ç”Ÿæˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç™¾åº¦-åŸºäºå¤§æ¨¡å‹çš„å¹¿å‘Šæ£€ç´¢</title>
    <link href="/2024/08/02/%E7%99%BE%E5%BA%A6-%E5%9F%BA%E4%BA%8E%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%9A%84%E5%B9%BF%E5%91%8A%E6%A3%80%E7%B4%A2/"/>
    <url>/2024/08/02/%E7%99%BE%E5%BA%A6-%E5%9F%BA%E4%BA%8E%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%9A%84%E5%B9%BF%E5%91%8A%E6%A3%80%E7%B4%A2/</url>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"><h1 id="æ•°æ®åˆ†æä»¥åŠåˆèµ›æ–¹æ³•">æ•°æ®åˆ†æä»¥åŠåˆèµ›æ–¹æ³•</h1><h2 id="queryè½åœ°é¡µæ ¸å¿ƒè¯é•¿åº¦åˆ†å¸ƒ">Queryã€è½åœ°é¡µã€æ ¸å¿ƒè¯é•¿åº¦åˆ†å¸ƒ</h2><figure><img src="/2024/08/02/%E7%99%BE%E5%BA%A6-%E5%9F%BA%E4%BA%8E%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%9A%84%E5%B9%BF%E5%91%8A%E6%A3%80%E7%B4%A2/query.png" alt="query"><figcaption aria-hidden="true">query</figcaption></figure><figure><img src="/2024/08/02/%E7%99%BE%E5%BA%A6-%E5%9F%BA%E4%BA%8E%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%9A%84%E5%B9%BF%E5%91%8A%E6%A3%80%E7%B4%A2/lp.png" alt="lp"><figcaption aria-hidden="true">lp</figcaption></figure><figure><img src="/2024/08/02/%E7%99%BE%E5%BA%A6-%E5%9F%BA%E4%BA%8E%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%9A%84%E5%B9%BF%E5%91%8A%E6%A3%80%E7%B4%A2/ct.png" alt="ct"><figcaption aria-hidden="true">ct</figcaption></figure><h2 id="å¹¿å‘Šidåˆ†å¸ƒ">å¹¿å‘ŠIDåˆ†å¸ƒ</h2><p>åœ¨å‘ç°Queryä¸­çš„IDè¿œå°‘äºå¹¿å‘ŠIDæ•°é‡åï¼Œæˆ‘æƒ³ç»Ÿè®¡IDçš„åˆ†å¸ƒã€‚æœ€å¼€å§‹é‡‡ç”¨æŸ±çŠ¶å›¾ï¼Œä½†ç”±äºæ•°æ®é‡è¿‡å¤§ï¼Œæœ€åç»˜åˆ¶å‡ºçš„å›¾åƒä¸ç›´è§‚ã€‚å› æ­¤ï¼Œæˆ‘å‘Kimié—®åˆ°äº†ä¸€ç§ä¼°è®¡åˆ†å¸ƒå¯†åº¦çš„æ–¹æ³•<a href="https://blog.csdn.net/weixin_39910711/article/details/107307509">KDE</a>ï¼Œè¿™æ˜¯ä¸€ç§éå‚æ•°ä¼°è®¡æ–¹æ³•ï¼Œç›¸å¯¹äºå‚æ•°ä¼°è®¡ï¼ˆå¦‚ï¼šæœ€å¤§ä¼¼ç„¶ä¼°è®¡ï¼‰ä¸éœ€è¦å¯¹æ•°æ®çš„åˆ†å¸ƒæœ‰å…ˆéªŒçš„è®¤è¯†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">from</span> scipy.stats <span class="hljs-keyword">import</span> gaussian_kde<br><br>json file =<span class="hljs-string">&#x27;/home/zym/æ¡Œé¢/FEIJIANG/Doc/Doc_train_ultra.json&#x27;</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(json file,<span class="hljs-string">&#x27;r&#x27;</span>,encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>)<span class="hljs-keyword">as</span> file:<br>    js =[json.loads(line)<span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file]<br>    <br>tgt_values=[ _[<span class="hljs-string">&#x27;tgt&#x27;</span>]<span class="hljs-keyword">for</span> <span class="hljs-keyword">in</span> js]<br>tgt_array=np.array(tgt_values,dtype=np.float64)<br><br><span class="hljs-comment"># å°†åˆ—è¡¨è½¬æ¢ä¸ºNumPyæ•°ç»„</span><br>tgt_array = np.array(tgt_values, dtype=np.float64)<br><br><span class="hljs-comment"># è®¡ç®—æ ¸å¯†åº¦ä¼°è®¡ï¼Œä½¿ç”¨é«˜æ–¯æ ¸</span><br>kde = gaussian_kde(tgt_array)<br><br><span class="hljs-comment"># ç»˜åˆ¶å¹³æ»‘çš„æ›²çº¿</span><br>x = np.linspace(np.<span class="hljs-built_in">min</span>(tgt_array), np.<span class="hljs-built_in">max</span>(tgt_array), <span class="hljs-number">1000</span>)<br>y = kde(x)<br></code></pre></td></tr></table></figure><figure><img src="/2024/08/02/%E7%99%BE%E5%BA%A6-%E5%9F%BA%E4%BA%8E%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%9A%84%E5%B9%BF%E5%91%8A%E6%A3%80%E7%B4%A2/IDåˆ†å¸ƒ.png" alt="åˆèµ›æ•°æ®çš„å¹¿å‘ŠIDåˆ†å¸ƒ"><figcaption aria-hidden="true">åˆèµ›æ•°æ®çš„å¹¿å‘ŠIDåˆ†å¸ƒ</figcaption></figure><h2 id="è®­ç»ƒè¿‡ç¨‹">è®­ç»ƒè¿‡ç¨‹</h2><p>åœ¨è®ºæ–‡ä¸­</p><h1 id="baseline">Baseline</h1><p>æ•°æ®é›†ä¸­æœ‰88wDocï¼Œå› ä¸ºè®ºæ–‡ä¸­æåˆ°ç›´æ¥ç´¢å¼•æ•ˆæœè¾ƒå¥½ï¼Œå› æ­¤å–è½åœ°é¡µè¿ç»­çš„çŸ­è¯­ä½œä¸ºDocï¼›ç‰¹åˆ«åœ°ï¼Œè§‚å¯Ÿåˆ°Docé•¿åº¦åˆ†å¸ƒä¸å‡ï¼Œå› æ­¤åœ¨ç”ŸæˆDocæ—¶è®¾å®šä¸ºé•¿åº¦è¶Šé•¿ã€é‡‡æ ·æ¬¡æ•°è¶Šå¤šã€‚æœ€ç»ˆå¾—åˆ°880wDocï¼Œåœ¨ç¬¬ä¸€é˜¶æ®µè¿›è¡Œç´¢å¼•å­¦ä¹ æ—¶4000stepså·²è¶‹äºæ”¶æ•›ï¼Œé‚æš‚åœã€‚</p><figure><img src="/2024/08/02/%E7%99%BE%E5%BA%A6-%E5%9F%BA%E4%BA%8E%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%9A%84%E5%B9%BF%E5%91%8A%E6%A3%80%E7%B4%A2/ç®€å•Doc.png" alt="ç®€å•æ„å»ºDoc"><figcaption aria-hidden="true">ç®€å•æ„å»ºDoc</figcaption></figure><p>å¯¹äºQueryï¼ŒæŒ‰Clickè¿›è¡Œå¢å¼ºï¼Œä»500wå¾—åˆ°1200wæ•°æ®ã€‚åœ¨ä¸Šä¸€æ­¥å¾—åˆ°çš„æƒé‡ä¸Šè®­ç»ƒï¼Œæ•ˆæœè¿˜å¯ä»¥ã€‚</p><h1 id="å°è¯•ä¸€semantic-docid">å°è¯•ä¸€ï¼šSemantic DocID</h1><p>å®˜æ–¹æ‰€ç»™çš„æ•°æ®é›†ä¸­IDæ˜¯æ²¡æœ‰è§„å¾‹çš„ï¼Œä¸åŒçš„å¹¿å‘Šå†…å®¹IDå¯èƒ½é‚»è¿‘ï¼Œç›¸ä¼¼çš„å¹¿å‘ŠIDå¯èƒ½å¾ˆè¿œï¼Œå› æ­¤è¿™å¯¹ç”Ÿæˆå¼æ¨¡å‹è€Œè¨€ï¼Œåƒæ˜¯åœ¨åšä¸€ä¸ªâ€œå¤šåˆ†ç±»â€çš„ä»»åŠ¡ã€‚åœ¨è¿™ç¯‡<a href="https://arxiv.org/abs/2309.13335">Model-enhanced Vector Index</a>è®ºæ–‡ä¸­æåˆ°åˆ©ç”¨Residual Quantizationè¿›è¡Œå±‚æ¬¡èšç±»æ•ˆæœå¯èƒ½ä¼šå¥½ï¼Œäºæ˜¯è€ƒè™‘ç”¨æ¨¡å‹å¯¹å¹¿å‘Šå†…å®¹è¿›è¡ŒEmbeddingï¼Œä½†å› ä¸ºæœ¬åœ°æ²¡æœ‰æ˜¾å¡ç”¨ï¼Œå¹¶ä¸”åœ¨AIstudioåˆä¸èƒ½ç”¨Pytorchï¼Œå› æ­¤é‡‡ç”¨<a href="https://paddlenlp.readthedocs.io/zh/latest/model_zoo/transformers/ERNIE/contents.html">Ernie-3.0-mini</a>ã€‚</p><h2 id="q1embeddingæ–‡ä»¶å¤ªå¤§">Q1ï¼šEmbeddingæ–‡ä»¶å¤ªå¤§</h2><p>å³ä½¿é‡‡ç”¨miniï¼Œåœ¨å¯¹çº¦29000ä¸ªå¥å­ï¼ˆ3%ï¼‰è¿›è¡ŒEmbeddingä¹‹åï¼Œæˆ‘çš„jsonæ–‡ä»¶å°±å·²ç»è¾¾åˆ°äº†220MB</p><p><img src="/2024/08/02/%E7%99%BE%E5%BA%A6-%E5%9F%BA%E4%BA%8E%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%9A%84%E5%B9%BF%E5%91%8A%E6%A3%80%E7%B4%A2/mini.png"></p><p>æ–‡ä»¶å­˜å‚¨æ ¼å¼å¦‚ä¸‹</p><p><img src="/2024/08/02/%E7%99%BE%E5%BA%A6-%E5%9F%BA%E4%BA%8E%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%9A%84%E5%B9%BF%E5%91%8A%E6%A3%80%E7%B4%A2/json.png"></p><h2 id="q2å†…å­˜è¿‡å¤§">Q2ï¼šå†…å­˜è¿‡å¤§</h2><p>å› ä¸ºè¯è¢‹æ–¹æ³•è€—æ—¶æ›´é•¿ï¼Œå ç”¨å†…å­˜æ›´å¤§ï¼Œåæ¥åˆå†æ¬¡å°è¯•ä½¿ç”¨Embeddingã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;/home/aistudio/embed.json&quot;</span>,<span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    data=[json.loads(line)<span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f]<br></code></pre></td></tr></table></figure><p>å±…ç„¶åœ¨è¯»å–çš„æ—¶å€™å†…å­˜å°±æ»¡äº†ã€‚</p><figure><img src="/2024/08/02/%E7%99%BE%E5%BA%A6-%E5%9F%BA%E4%BA%8E%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%9A%84%E5%B9%BF%E5%91%8A%E6%A3%80%E7%B4%A2/å†…å­˜.png" alt="å†…å­˜æ»¡äº†"><figcaption aria-hidden="true">å†…å­˜æ»¡äº†</figcaption></figure><h1 id="å°è¯•äºŒè¯è¢‹">å°è¯•äºŒï¼šè¯è¢‹</h1><p>è¿™é‡Œä½¿ç”¨Paddleé‡Œçš„Taskflowè¿›è¡Œåˆ†è¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./embed.json&quot;</span>,<span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> f:<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-built_in">len</span>(res)+<span class="hljs-number">1</span>)):<br>        seg = Taskflow(<span class="hljs-string">&quot;word segmentation&quot;</span>)temp = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">filter</span>(<span class="hljs-keyword">lambda</span> x:x!=,<span class="hljs-string">&#x27;,seg(res[str(i)])))</span><br><span class="hljs-string">        # ä½¿ç”¨counterè®¡ç®—æ¯ä¸ªåˆ†è¯å‡ºç°çš„æ¬¡æ•°</span><br><span class="hljs-string">        word count= counter(temp)</span><br><span class="hljs-string">        #æŒ‰ç…§å‡ºç°æ¬¡æ•°è¿›è¡Œå‡åºæ’åº</span><br><span class="hljs-string">        sorted word count = dict(sorted(word count.items(), key=lambda item: item[1]))</span><br><span class="hljs-string">        json.dump(&#123;&quot;tgt&quot;:i,&quot;bow&quot;: sorted word count&#125;,f,ensure ascii=False)</span><br></code></pre></td></tr></table></figure><p>æœ€ç»ˆåˆ†è¯ç»“æœæ–‡ä»¶å¾ˆå¤§ï¼Œæ²¡æœ‰è¿›ä¸€æ­¥å¤„ç†ã€‚</p><figure><img src="/2024/08/02/%E7%99%BE%E5%BA%A6-%E5%9F%BA%E4%BA%8E%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%9A%84%E5%B9%BF%E5%91%8A%E6%A3%80%E7%B4%A2/åˆ†è¯.png" alt="åˆ†è¯ç»“æœ"><figcaption aria-hidden="true">åˆ†è¯ç»“æœ</figcaption></figure>]]></content>
    
    
    <categories>
      
      <category>æŠ€æœ¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å¤§æ¨¡å‹</tag>
      
      <tag>ç™¾åº¦</tag>
      
      <tag>æœå¹¿æ¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BIGAI2â€”å¾®è°ƒQwen-7Bç”Ÿæˆ1-Hopæè¿°</title>
    <link href="/2024/07/31/%E5%BE%AE%E8%B0%83Qwen-7B/"/>
    <url>/2024/07/31/%E5%BE%AE%E8%B0%83Qwen-7B/</url>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"><h1 id="èƒŒæ™¯">èƒŒæ™¯</h1><p>åœ¨ç”ŸæˆQAæ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›ç”Ÿæˆçš„æ•°æ®å…·æœ‰<mark>ä¸€å®šçš„å¤æ‚åº¦</mark>ï¼Œå¹¶ä¸”å…·æœ‰<mark>ç”Ÿæ´»åŒ–</mark>çš„ç‰¹ç‚¹ã€‚</p><p>æœ€åŸºæœ¬çš„ä¸€ä¸ªæƒ³æ³•æ˜¯ï¼šå½“æˆ‘ä»¬éœ€è¦æŸä¸ªå­å›¾ï¼ˆRegion Graphï¼‰ä¸­çš„ç‰©ä½“ä¿¡æ¯ï¼Œä¾¿ç›´æ¥ä»å·²æœ‰ä¿¡æ¯Infoä¸­æŸ¥æ‰¾ï¼Œå¹¶é€å…¥GPTç”ŸæˆQAï¼›ç„¶è€Œï¼ŒåŸºäºè¿™ç§æ–¹æ³•æ‰€ç”Ÿæˆçš„QAååˆ†çš„ç®€å•ã€‚æˆ‘åˆ©ç”¨GPT-4ç®€å•ç”Ÿæˆäº†ä¸€ä¸ªDemoï¼Œå¦‚ä¸‹å›¾ï¼š</p><figure><img src="/2024/07/31/%E5%BE%AE%E8%B0%83Qwen-7B/Base.png" alt="Demo:ç›´æ¥é€šè¿‡çŸ¥è¯†å›¾è°±ç”Ÿæˆçš„QA"><figcaption aria-hidden="true">Demo:ç›´æ¥é€šè¿‡çŸ¥è¯†å›¾è°±ç”Ÿæˆçš„QA</figcaption></figure><p>å¾ˆæ˜¾ç„¶è¿™ç§æ•°æ®ä¸å…·æœ‰<mark>å¤šæ ·æ€§</mark>ï¼Œä¹Ÿä¸æ»¡è¶³æˆ‘ä»¬çš„è¦æ±‚ã€‚æˆ‘ä»¬è®¤ä¸ºåœ¨è‹¥å¹²å®šè¯­ä¿®é¥°åçš„QAå¯ä»¥æå¤§åœ°ä¸°å¯Œæ•°æ®å¤šæ ·æ€§ï¼š</p><ul><li>åœ°æ¯¯å·¦é¢ç´§æŒ¨çš„å„¿ç«¥æ¤…å’Œè¡Œæç®±æ—çš„åŒäººåºŠå“ªä¸ªæ›´å¤§ï¼Ÿ</li><li>ç©ºè°ƒä¸‹é¢çš„æŒ‚ç”»å’Œå¢™å£å³è¾¹çš„è¡£æœå“ªä¸ªæ•°é‡æ›´å¤šï¼Ÿ</li></ul><p>æœ¬è´¨ä¸Šï¼Œæˆ‘ä»¬å¸Œæœ›å¯¹åŸæœ‰æ•°æ®å¢åŠ ä¸€å®šçš„å®šè¯­â€”â€”<mark>å°†ç¨‹å¼åŒ–çš„çŸ­è¯­è½¬å˜ä¸ºæµç•…ä¸°å¯Œçš„å¥å­</mark>ï¼Œæ•ˆæœå¦‚ä¸‹å›¾ï¼š</p><figure><img src="/2024/07/31/%E5%BE%AE%E8%B0%83Qwen-7B/Improve.png" alt="1-Hopæè¿°ï¼ˆå³ï¼‰å¯ä»¥ä¸°å¯ŒQAå†…å®¹"><figcaption aria-hidden="true">1-Hopæè¿°ï¼ˆå³ï¼‰å¯ä»¥ä¸°å¯ŒQAå†…å®¹</figcaption></figure><p>ç”Ÿæˆå¤§æ‰¹é‡æ•°æ®ç¦»ä¸å¼€å¤§æ¨¡å‹çš„å¸®åŠ©ã€‚å‡ºäºå¯¹è®¡ç®—èµ„æºä»¥åŠç”Ÿæˆæ•ˆç‡çš„è€ƒè™‘ï¼Œæˆ‘ä»¬æ²¡æœ‰é€‰æ‹©APIæˆ–æ˜¯å‚æ•°é‡æ›´å¤§çš„æ¨¡å‹ï¼Œè€Œæ˜¯åœ¨æœ¬åœ°éƒ¨ç½²Qwen-7Bï¼Œå¹¶æœŸå¾…é€šè¿‡å¾®è°ƒå¯ä»¥è®©å…¶ç”Ÿæˆæˆ‘ä»¬å¸Œæœ›çš„1-Hopæè¿°ï¼Œå¦‚ä¸‹å›¾æ¡†å‡ºéƒ¨åˆ†ï¼š</p><figure><img src="/2024/07/31/%E5%BE%AE%E8%B0%83Qwen-7B/æµç¨‹.png" alt="ç”ŸæˆQAæ•°æ®é›†æµç¨‹"><figcaption aria-hidden="true">ç”ŸæˆQAæ•°æ®é›†æµç¨‹</figcaption></figure><h1 id="æ–¹æ³•">æ–¹æ³•</h1><h2 id="åŸç†æµ…æ">åŸç†æµ…æ</h2><p>é™¤äº†SFTä¹‹å¤–ï¼Œäººä»¬é‡‡ç”¨æ›´å°‘è®¡ç®—èµ„æºè¿›è¡Œå¾®è°ƒçš„æ–¹æ³•ç§°ä¸ºPEFTï¼Œå…¶ä¸­åˆåŒ…å«è‹¥å¹²ç§æ–¹æ³•ã€‚</p><p>æˆ‘åœ¨ç½‘ä¸Šæ‰¾åˆ°çš„ä¸€ä¸ªæ—¶é—´è½´ï¼Œå¯ä»¥å¾ˆå¥½åœ°å±•ç¤ºå‘å±•å†ç¨‹ï¼Œå¦‚ä¸‹å›¾ï¼š</p><figure><img src="https://oscimg.oschina.net/oscnet/9ac87619-bf4f-41d6-9c94-d7a8cb030acb.png" alt="ä¸»æµå¾®è°ƒæ–¹æ³•çš„å‘å±•"><figcaption aria-hidden="true">ä¸»æµå¾®è°ƒæ–¹æ³•çš„å‘å±•</figcaption></figure><p>å› ä¸ºæ˜¾å¡èµ„æºçš„é™åˆ¶ï¼Œæˆ‘ä»¬é‡‡ç”¨P-tuningæ¥è¿›è¡Œå¾®è°ƒï¼Œä»è€Œç”Ÿæˆ1-Hopæè¿°ï¼Œ<a href="https://arxiv.org/abs/2103.10385">è®ºæ–‡åŸæ–‡</a>ã€‚</p><p>ä¸Prefix-tuningç›´æ¥ç»™Promptå¢åŠ å‰ç¼€ä¸åŒï¼ŒP-tuningåœ¨Promptä¸­éšæ„åŠ å…¥Embeddingåçš„Virtual Tokenï¼Œå¦‚ä¸‹å›¾ï¼š</p><figure><img src="/2024/07/31/%E5%BE%AE%E8%B0%83Qwen-7B/P-tuning.png" alt="P-tuningç»“æ„ç¤ºæ„å›¾"><figcaption aria-hidden="true">P-tuningç»“æ„ç¤ºæ„å›¾</figcaption></figure><h2 id="è®­ç»ƒæ•°æ®">è®­ç»ƒæ•°æ®</h2><p>è€ƒè™‘åˆ°æ—¶é—´æˆæœ¬ä»¥åŠTokenæˆæœ¬ï¼Œæˆ‘ä»¬å†³å®šåœ¨Infoä¸­é€‰å–<mark>éƒ¨åˆ†æ•°æ®</mark>ï¼Œå°†è¿™ä¸€éƒ¨åˆ†æ•°æ®å’Œåˆ©ç”¨GPT-4ç”Ÿæˆçš„1-Hopæè¿°æ‹¼æ¥åœ¨ä¸€èµ·ï¼Œå½¢æˆäº†å¾®è°ƒç”¨çš„è®­ç»ƒæ•°æ®é›†ã€‚</p><figure><img src="/2024/07/31/%E5%BE%AE%E8%B0%83Qwen-7B/æ•°æ®.png" alt="å‡†å¤‡å¾®è°ƒæ•°æ®"><figcaption aria-hidden="true">å‡†å¤‡å¾®è°ƒæ•°æ®</figcaption></figure><p>é€šè¿‡å°†äººå·¥åˆ¶ä½œçš„æ¨¡æ¿ï¼ˆå¦‚ä¸‹å›¾ï¼‰ä¸Infoä¸­çš„ä¿¡æ¯ä½œä¸ºPromptï¼Œæˆ‘ä»¬åˆ©ç”¨GPT-4è¿›è¡Œç”Ÿæˆï¼›ç”Ÿæˆçš„å†…å®¹éœ€è¦è¿›ä¸€æ­¥é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼çš„å¤„ç†ï¼Œæœ€ç»ˆæˆä¸º1-Hopæè¿°ã€‚</p><figure><img src="/2024/07/31/%E5%BE%AE%E8%B0%83Qwen-7B/GPT1.png" alt="æ¨¡æ¿1"><figcaption aria-hidden="true">æ¨¡æ¿1</figcaption></figure><figure><img src="/2024/07/31/%E5%BE%AE%E8%B0%83Qwen-7B/GPT2.png" alt="æ¨¡æ¿2"><figcaption aria-hidden="true">æ¨¡æ¿2</figcaption></figure><figure><img src="/2024/07/31/%E5%BE%AE%E8%B0%83Qwen-7B/GPT3.png" alt="æ¨¡æ¿3"><figcaption aria-hidden="true">æ¨¡æ¿3</figcaption></figure><h2 id="è®­ç»ƒè¿‡ç¨‹">è®­ç»ƒè¿‡ç¨‹</h2><p>Qwen-7Bæ¥æ”¶åˆ°çš„Promptç”±å¦ä¸€å¥—æ¨¡æ¿ä»¥åŠInfoä¸­çš„ä¿¡æ¯ç»„æˆï¼Œå¦‚ä¸‹å›¾ï¼š</p><figure><img src="/2024/07/31/%E5%BE%AE%E8%B0%83Qwen-7B/Prompt.png" alt="è¯¢é—®åŠŸèƒ½çš„æ¨¡æ¿"><figcaption aria-hidden="true">è¯¢é—®åŠŸèƒ½çš„æ¨¡æ¿</figcaption></figure><p>ä»£ç éœ€è¦æ”¾åˆ°HGXé›†ç¾¤ä¸Šè·‘ï¼Œä½†æ˜¯éœ€è¦æ’é˜Ÿå¾ˆä¹…ã€‚ä¹‹å‰å¾®è°ƒçš„æ—¶å€™lossä»14ä¸‹é™åˆ°8å·¦å³ã€‚</p><figure><img src="/2024/07/31/%E5%BE%AE%E8%B0%83Qwen-7B/HGX.png" alt="GPUé›†ç¾¤"><figcaption aria-hidden="true">GPUé›†ç¾¤</figcaption></figure><h1 id="ç»“æœ">ç»“æœ</h1><p>æ•´ä¸ªå¯¹Infoè¿›è¡Œå¢å¼ºç”Ÿæˆ1-Hopæè¿°çš„è¿‡ç¨‹å¾ˆæ…¢ï¼Œæœ€ç»ˆä¹Ÿæ²¡æœ‰å°†æ•´ä¸ªmapçš„3000ä¸ªè§†è§’ï¼ˆ1000ä¸ªåœºæ™¯*3ä¸ªè§†è§’ï¼‰éå†å®Œã€‚</p><figure><img src="/2024/07/31/%E5%BE%AE%E8%B0%83Qwen-7B/ç»“æœ.png" alt="ç»“æœ"><figcaption aria-hidden="true">ç»“æœ</figcaption></figure>]]></content>
    
    
    <categories>
      
      <category>æŠ€æœ¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å¾®è°ƒ</tag>
      
      <tag>å®ä¹ </tag>
      
      <tag>BIGAI</tag>
      
      <tag>æ•°æ®ç”Ÿæˆ</tag>
      
      <tag>å¤§æ¨¡å‹</tag>
      
      <tag>P-tuning</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
